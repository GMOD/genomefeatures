(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function Be(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function qa(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ei(t){let e,n,r;t.length!==2?(e=Be,n=(o,c)=>Be(t(o),c),r=(o,c)=>t(o)-c):(e=t===Be||t===qa?t:Ga,n=t,r=t);function i(o,c,l=0,f=o.length){if(l<f){if(e(c,c)!==0)return f;do{const d=l+f>>>1;n(o[d],c)<0?l=d+1:f=d}while(l<f)}return l}function a(o,c,l=0,f=o.length){if(l<f){if(e(c,c)!==0)return f;do{const d=l+f>>>1;n(o[d],c)<=0?l=d+1:f=d}while(l<f)}return l}function s(o,c,l=0,f=o.length){const d=i(o,c,l,f-1);return d>l&&r(o[d-1],c)>-r(o[d],c)?d-1:d}return{left:i,center:s,right:a}}function Ga(){return 0}function Wa(t){return t===null?NaN:+t}const Xa=Ei(Be),Za=Xa.right;Ei(Wa).center;const Ya=Math.sqrt(50),Ka=Math.sqrt(10),Ja=Math.sqrt(2);function Ge(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),s=a>=Ya?10:a>=Ka?5:a>=Ja?2:1;let o,c,l;return i<0?(l=Math.pow(10,-i)/s,o=Math.round(t*l),c=Math.round(e*l),o/l<t&&++o,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*s,o=Math.round(t/l),c=Math.round(e/l),o*l<t&&++o,c*l>e&&--c),c<o&&.5<=n&&n<2?Ge(t,e,n*2):[o,c,l]}function Qa(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,s]=r?Ge(e,t,n):Ge(t,e,n);if(!(a>=i))return[];const o=a-i+1,c=new Array(o);if(r)if(s<0)for(let l=0;l<o;++l)c[l]=(a-l)/-s;else for(let l=0;l<o;++l)c[l]=(a-l)*s;else if(s<0)for(let l=0;l<o;++l)c[l]=(i+l)/-s;else for(let l=0;l<o;++l)c[l]=(i+l)*s;return c}function Sn(t,e,n){return e=+e,t=+t,n=+n,Ge(t,e,n)[2]}function ja(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Sn(e,t,n):Sn(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function ts(t){return t}var He=1,dn=2,Nn=3,Te=4,wr=1e-6;function es(t){return"translate("+t+",0)"}function ns(t){return"translate(0,"+t+")"}function rs(t){return e=>+t(e)}function is(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function as(){return!this.__axis}function Ti(t,e){var n=[],r=null,i=null,a=6,s=6,o=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=t===He||t===Te?-1:1,f=t===Te||t===dn?"x":"y",d=t===He||t===Nn?es:ns;function u(h){var w=r??(e.ticks?e.ticks.apply(e,n):e.domain()),T=i??(e.tickFormat?e.tickFormat.apply(e,n):ts),$=Math.max(a,0)+o,k=e.range(),g=+k[0]+c,_=+k[k.length-1]+c,p=(e.bandwidth?is:rs)(e.copy(),c),v=h.selection?h.selection():h,E=v.selectAll(".domain").data([null]),y=v.selectAll(".tick").data(w,e).order(),A=y.exit(),x=y.enter().append("g").attr("class","tick"),b=y.select("line"),m=y.select("text");E=E.merge(E.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),y=y.merge(x),b=b.merge(x.append("line").attr("stroke","currentColor").attr(f+"2",l*a)),m=m.merge(x.append("text").attr("fill","currentColor").attr(f,l*$).attr("dy",t===He?"0em":t===Nn?"0.71em":"0.32em")),h!==v&&(E=E.transition(h),y=y.transition(h),b=b.transition(h),m=m.transition(h),A=A.transition(h).attr("opacity",wr).attr("transform",function(N){return isFinite(N=p(N))?d(N+c):this.getAttribute("transform")}),x.attr("opacity",wr).attr("transform",function(N){var V=this.parentNode.__axis;return d((V&&isFinite(V=V(N))?V:p(N))+c)})),A.remove(),E.attr("d",t===Te||t===dn?s?"M"+l*s+","+g+"H"+c+"V"+_+"H"+l*s:"M"+c+","+g+"V"+_:s?"M"+g+","+l*s+"V"+c+"H"+_+"V"+l*s:"M"+g+","+c+"H"+_),y.attr("opacity",1).attr("transform",function(N){return d(p(N)+c)}),b.attr(f+"2",l*a),m.attr(f,l*$).text(T),v.filter(as).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===dn?"start":t===Te?"end":"middle"),v.each(function(){this.__axis=p})}return u.scale=function(h){return arguments.length?(e=h,u):e},u.ticks=function(){return n=Array.from(arguments),u},u.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),u):n.slice()},u.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),u):r&&r.slice()},u.tickFormat=function(h){return arguments.length?(i=h,u):i},u.tickSize=function(h){return arguments.length?(a=s=+h,u):a},u.tickSizeInner=function(h){return arguments.length?(a=+h,u):a},u.tickSizeOuter=function(h){return arguments.length?(s=+h,u):s},u.tickPadding=function(h){return arguments.length?(o=+h,u):o},u.offset=function(h){return arguments.length?(c=+h,u):c},u}function yr(t){return Ti(He,t)}function ss(t){return Ti(Nn,t)}var os={value:()=>{}};function Jn(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ce(n)}function Ce(t){this._=t}function ls(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ce.prototype=Jn.prototype={constructor:Ce,on:function(t,e){var n=this._,r=ls(t+"",n),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(t=r[a]).type)&&(i=cs(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=r[a]).type)n[i]=vr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=vr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ce(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function cs(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function vr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=os,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Mn="http://www.w3.org/1999/xhtml";const xr={svg:"http://www.w3.org/2000/svg",xhtml:Mn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function on(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),xr.hasOwnProperty(e)?{space:xr[e],local:t}:t}function fs(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Mn&&e.documentElement.namespaceURI===Mn?e.createElement(t):e.createElementNS(n,t)}}function us(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ri(t){var e=on(t);return(e.local?us:fs)(e)}function hs(){}function Qn(t){return t==null?hs:function(){return this.querySelector(t)}}function ds(t){typeof t!="function"&&(t=Qn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=new Array(s),c,l,f=0;f<s;++f)(c=a[f])&&(l=t.call(c,c.__data__,f,a))&&("__data__"in c&&(l.__data__=c.__data__),o[f]=l);return new wt(r,this._parents)}function Si(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ps(){return[]}function Ni(t){return t==null?ps:function(){return this.querySelectorAll(t)}}function ms(t){return function(){return Si(t.apply(this,arguments))}}function gs(t){typeof t=="function"?t=ms(t):t=Ni(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s=e[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&(r.push(t.call(c,c.__data__,l,s)),i.push(c));return new wt(r,i)}function Mi(t){return function(){return this.matches(t)}}function Di(t){return function(e){return e.matches(t)}}var _s=Array.prototype.find;function ws(t){return function(){return _s.call(this.children,t)}}function ys(){return this.firstElementChild}function vs(t){return this.select(t==null?ys:ws(typeof t=="function"?t:Di(t)))}var xs=Array.prototype.filter;function bs(){return Array.from(this.children)}function ks(t){return function(){return xs.call(this.children,t)}}function As(t){return this.selectAll(t==null?bs:ks(typeof t=="function"?t:Di(t)))}function $s(t){typeof t!="function"&&(t=Mi(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new wt(r,this._parents)}function Ii(t){return new Array(t.length)}function Es(){return new wt(this._enter||this._groups.map(Ii),this._parents)}function We(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}We.prototype={constructor:We,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ts(t){return function(){return t}}function Rs(t,e,n,r,i,a){for(var s=0,o,c=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new We(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function Ss(t,e,n,r,i,a,s){var o,c,l=new Map,f=e.length,d=a.length,u=new Array(f),h;for(o=0;o<f;++o)(c=e[o])&&(u[o]=h=s.call(c,c.__data__,o,e)+"",l.has(h)?i[o]=c:l.set(h,c));for(o=0;o<d;++o)h=s.call(t,a[o],o,a)+"",(c=l.get(h))?(r[o]=c,c.__data__=a[o],l.delete(h)):n[o]=new We(t,a[o]);for(o=0;o<f;++o)(c=e[o])&&l.get(u[o])===c&&(i[o]=c)}function Ns(t){return t.__data__}function Ms(t,e){if(!arguments.length)return Array.from(this,Ns);var n=e?Ss:Rs,r=this._parents,i=this._groups;typeof t!="function"&&(t=Ts(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),l=0;l<a;++l){var f=r[l],d=i[l],u=d.length,h=Ds(t.call(f,f&&f.__data__,l,r)),w=h.length,T=o[l]=new Array(w),$=s[l]=new Array(w),k=c[l]=new Array(u);n(f,d,T,$,k,h,e);for(var g=0,_=0,p,v;g<w;++g)if(p=T[g]){for(g>=_&&(_=g+1);!(v=$[_])&&++_<w;);p._next=v||null}}return s=new wt(s,r),s._enter=o,s._exit=c,s}function Ds(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Is(){return new wt(this._exit||this._groups.map(Ii),this._parents)}function Os(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Fs(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,s=Math.min(i,a),o=new Array(i),c=0;c<s;++c)for(var l=n[c],f=r[c],d=l.length,u=o[c]=new Array(d),h,w=0;w<d;++w)(h=l[w]||f[w])&&(u[w]=h);for(;c<i;++c)o[c]=n[c];return new wt(o,this._parents)}function Ls(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Vs(t){t||(t=Bs);function e(d,u){return d&&u?t(d.__data__,u.__data__):!d-!u}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s=n[a],o=s.length,c=i[a]=new Array(o),l,f=0;f<o;++f)(l=s[f])&&(c[f]=l);c.sort(e)}return new wt(i,this._parents).order()}function Bs(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Hs(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Cs(){return Array.from(this)}function zs(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function Us(){let t=0;for(const e of this)++t;return t}function Ps(){return!this.node()}function qs(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function Gs(t){return function(){this.removeAttribute(t)}}function Ws(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xs(t,e){return function(){this.setAttribute(t,e)}}function Zs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ys(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ks(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Js(t,e){var n=on(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ws:Gs:typeof e=="function"?n.local?Ks:Ys:n.local?Zs:Xs)(n,e))}function Oi(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Qs(t){return function(){this.style.removeProperty(t)}}function js(t,e,n){return function(){this.style.setProperty(t,e,n)}}function to(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function eo(t,e,n){return arguments.length>1?this.each((e==null?Qs:typeof e=="function"?to:js)(t,e,n??"")):se(this.node(),t)}function se(t,e){return t.style.getPropertyValue(e)||Oi(t).getComputedStyle(t,null).getPropertyValue(e)}function no(t){return function(){delete this[t]}}function ro(t,e){return function(){this[t]=e}}function io(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ao(t,e){return arguments.length>1?this.each((e==null?no:typeof e=="function"?io:ro)(t,e)):this.node()[t]}function Fi(t){return t.trim().split(/^|\s+/)}function jn(t){return t.classList||new Li(t)}function Li(t){this._node=t,this._names=Fi(t.getAttribute("class")||"")}Li.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Vi(t,e){for(var n=jn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Bi(t,e){for(var n=jn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function so(t){return function(){Vi(this,t)}}function oo(t){return function(){Bi(this,t)}}function lo(t,e){return function(){(e.apply(this,arguments)?Vi:Bi)(this,t)}}function co(t,e){var n=Fi(t+"");if(arguments.length<2){for(var r=jn(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?lo:e?so:oo)(n,e))}function fo(){this.textContent=""}function uo(t){return function(){this.textContent=t}}function ho(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function po(t){return arguments.length?this.each(t==null?fo:(typeof t=="function"?ho:uo)(t)):this.node().textContent}function mo(){this.innerHTML=""}function go(t){return function(){this.innerHTML=t}}function _o(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function wo(t){return arguments.length?this.each(t==null?mo:(typeof t=="function"?_o:go)(t)):this.node().innerHTML}function yo(){this.nextSibling&&this.parentNode.appendChild(this)}function vo(){return this.each(yo)}function xo(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function bo(){return this.each(xo)}function ko(t){var e=typeof t=="function"?t:Ri(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ao(){return null}function $o(t,e){var n=typeof t=="function"?t:Ri(t),r=e==null?Ao:typeof e=="function"?e:Qn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Eo(){var t=this.parentNode;t&&t.removeChild(this)}function To(){return this.each(Eo)}function Ro(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function So(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function No(t){return this.select(t?So:Ro)}function Mo(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Do(t){return function(e){t.call(this,e,this.__data__)}}function Io(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Oo(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Fo(t,e,n){return function(){var r=this.__on,i,a=Do(e);if(r){for(var s=0,o=r.length;s<o;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Lo(t,e,n){var r=Io(t+""),i,a=r.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,f;c<l;++c)for(i=0,f=o[c];i<a;++i)if((s=r[i]).type===f.type&&s.name===f.name)return f.value}return}for(o=e?Fo:Oo,i=0;i<a;++i)this.each(o(r[i],e,n));return this}function Hi(t,e,n){var r=Oi(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Vo(t,e){return function(){return Hi(this,t,e)}}function Bo(t,e){return function(){return Hi(this,t,e.apply(this,arguments))}}function Ho(t,e){return this.each((typeof e=="function"?Bo:Vo)(t,e))}function*Co(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,s;i<a;++i)(s=r[i])&&(yield s)}var tr=[null];function wt(t,e){this._groups=t,this._parents=e}function Kt(){return new wt([[document.documentElement]],tr)}function zo(){return this}wt.prototype=Kt.prototype={constructor:wt,select:ds,selectAll:gs,selectChild:vs,selectChildren:As,filter:$s,data:Ms,enter:Es,exit:Is,join:Os,merge:Fs,selection:zo,order:Ls,sort:Vs,call:Hs,nodes:Cs,node:zs,size:Us,empty:Ps,each:qs,attr:Js,style:eo,property:ao,classed:co,text:po,html:wo,raise:vo,lower:bo,append:ko,insert:$o,remove:To,clone:No,datum:Mo,on:Lo,dispatch:Ho,[Symbol.iterator]:Co};function G(t){return typeof t=="string"?new wt([[document.querySelector(t)]],[document.documentElement]):new wt([[t]],tr)}function Uo(t){let e;for(;e=t.sourceEvent;)t=e;return t}function br(t,e){if(t=Uo(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function Rt(t){return typeof t=="string"?new wt([document.querySelectorAll(t)],[document.documentElement]):new wt([Si(t)],tr)}const Po={passive:!1},we={capture:!0,passive:!1};function pn(t){t.stopImmediatePropagation()}function ie(t){t.preventDefault(),t.stopImmediatePropagation()}function qo(t){var e=t.document.documentElement,n=G(t).on("dragstart.drag",ie,we);"onselectstart"in e?n.on("selectstart.drag",ie,we):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Go(t,e){var n=t.document.documentElement,r=G(t).on("dragstart.drag",null);e&&(r.on("click.drag",ie,we),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Re=t=>()=>t;function Dn(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:s,y:o,dx:c,dy:l,dispatch:f}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:f}})}Dn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Wo(t){return!t.ctrlKey&&!t.button}function Xo(){return this.parentNode}function Zo(t,e){return e??{x:t.x,y:t.y}}function Yo(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ko(){var t=Wo,e=Xo,n=Zo,r=Yo,i={},a=Jn("start","drag","end"),s=0,o,c,l,f,d=0;function u(p){p.on("mousedown.drag",h).filter(r).on("touchstart.drag",$).on("touchmove.drag",k,Po).on("touchend.drag touchcancel.drag",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(p,v){if(!(f||!t.call(this,p,v))){var E=_(this,e.call(this,p,v),p,v,"mouse");E&&(G(p.view).on("mousemove.drag",w,we).on("mouseup.drag",T,we),qo(p.view),pn(p),l=!1,o=p.clientX,c=p.clientY,E("start",p))}}function w(p){if(ie(p),!l){var v=p.clientX-o,E=p.clientY-c;l=v*v+E*E>d}i.mouse("drag",p)}function T(p){G(p.view).on("mousemove.drag mouseup.drag",null),Go(p.view,l),ie(p),i.mouse("end",p)}function $(p,v){if(t.call(this,p,v)){var E=p.changedTouches,y=e.call(this,p,v),A=E.length,x,b;for(x=0;x<A;++x)(b=_(this,y,p,v,E[x].identifier,E[x]))&&(pn(p),b("start",p,E[x]))}}function k(p){var v=p.changedTouches,E=v.length,y,A;for(y=0;y<E;++y)(A=i[v[y].identifier])&&(ie(p),A("drag",p,v[y]))}function g(p){var v=p.changedTouches,E=v.length,y,A;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),y=0;y<E;++y)(A=i[v[y].identifier])&&(pn(p),A("end",p,v[y]))}function _(p,v,E,y,A,x){var b=a.copy(),m=br(x||E,v),N,V,C;if((C=n.call(p,new Dn("beforestart",{sourceEvent:E,target:u,identifier:A,active:s,x:m[0],y:m[1],dx:0,dy:0,dispatch:b}),y))!=null)return N=C.x-m[0]||0,V=C.y-m[1]||0,function W(M,et,ot){var S=m,Z;switch(M){case"start":i[A]=W,Z=s++;break;case"end":delete i[A],--s;case"drag":m=br(ot||et,v),Z=s;break}b.call(M,p,new Dn(M,{sourceEvent:et,subject:C,target:u,identifier:A,active:Z,x:m[0]+N,y:m[1]+V,dx:m[0]-S[0],dy:m[1]-S[1],dispatch:b}),y)}}return u.filter=function(p){return arguments.length?(t=typeof p=="function"?p:Re(!!p),u):t},u.container=function(p){return arguments.length?(e=typeof p=="function"?p:Re(p),u):e},u.subject=function(p){return arguments.length?(n=typeof p=="function"?p:Re(p),u):n},u.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:Re(!!p),u):r},u.on=function(){var p=a.on.apply(a,arguments);return p===a?u:p},u.clickDistance=function(p){return arguments.length?(d=(p=+p)*p,u):Math.sqrt(d)},u}function er(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ci(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function $e(){}var ye=.7,Xe=1/ye,ae="\\s*([+-]?\\d+)\\s*",ve="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Jo=/^#([0-9a-f]{3,8})$/,Qo=new RegExp(`^rgb\\(${ae},${ae},${ae}\\)$`),jo=new RegExp(`^rgb\\(${Ot},${Ot},${Ot}\\)$`),tl=new RegExp(`^rgba\\(${ae},${ae},${ae},${ve}\\)$`),el=new RegExp(`^rgba\\(${Ot},${Ot},${Ot},${ve}\\)$`),nl=new RegExp(`^hsl\\(${ve},${Ot},${Ot}\\)$`),rl=new RegExp(`^hsla\\(${ve},${Ot},${Ot},${ve}\\)$`),kr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};er($e,Jt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ar,formatHex:Ar,formatHex8:il,formatHsl:al,formatRgb:$r,toString:$r});function Ar(){return this.rgb().formatHex()}function il(){return this.rgb().formatHex8()}function al(){return zi(this).formatHsl()}function $r(){return this.rgb().formatRgb()}function Jt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Jo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Er(e):n===3?new vt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Se(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Se(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Qo.exec(t))?new vt(e[1],e[2],e[3],1):(e=jo.exec(t))?new vt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=tl.exec(t))?Se(e[1],e[2],e[3],e[4]):(e=el.exec(t))?Se(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=nl.exec(t))?Sr(e[1],e[2]/100,e[3]/100,1):(e=rl.exec(t))?Sr(e[1],e[2]/100,e[3]/100,e[4]):kr.hasOwnProperty(t)?Er(kr[t]):t==="transparent"?new vt(NaN,NaN,NaN,0):null}function Er(t){return new vt(t>>16&255,t>>8&255,t&255,1)}function Se(t,e,n,r){return r<=0&&(t=e=n=NaN),new vt(t,e,n,r)}function sl(t){return t instanceof $e||(t=Jt(t)),t?(t=t.rgb(),new vt(t.r,t.g,t.b,t.opacity)):new vt}function In(t,e,n,r){return arguments.length===1?sl(t):new vt(t,e,n,r??1)}function vt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}er(vt,In,Ci($e,{brighter(t){return t=t==null?Xe:Math.pow(Xe,t),new vt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ye:Math.pow(ye,t),new vt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vt(Xt(this.r),Xt(this.g),Xt(this.b),Ze(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tr,formatHex:Tr,formatHex8:ol,formatRgb:Rr,toString:Rr}));function Tr(){return`#${Wt(this.r)}${Wt(this.g)}${Wt(this.b)}`}function ol(){return`#${Wt(this.r)}${Wt(this.g)}${Wt(this.b)}${Wt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Rr(){const t=Ze(this.opacity);return`${t===1?"rgb(":"rgba("}${Xt(this.r)}, ${Xt(this.g)}, ${Xt(this.b)}${t===1?")":`, ${t})`}`}function Ze(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Xt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Wt(t){return t=Xt(t),(t<16?"0":"")+t.toString(16)}function Sr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Mt(t,e,n,r)}function zi(t){if(t instanceof Mt)return new Mt(t.h,t.s,t.l,t.opacity);if(t instanceof $e||(t=Jt(t)),!t)return new Mt;if(t instanceof Mt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(n-r)/o+(n<r)*6:n===a?s=(r-e)/o+2:s=(e-n)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new Mt(s,o,c,t.opacity)}function ll(t,e,n,r){return arguments.length===1?zi(t):new Mt(t,e,n,r??1)}function Mt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}er(Mt,ll,Ci($e,{brighter(t){return t=t==null?Xe:Math.pow(Xe,t),new Mt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ye:Math.pow(ye,t),new Mt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new vt(mn(t>=240?t-240:t+120,i,r),mn(t,i,r),mn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Mt(Nr(this.h),Ne(this.s),Ne(this.l),Ze(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ze(this.opacity);return`${t===1?"hsl(":"hsla("}${Nr(this.h)}, ${Ne(this.s)*100}%, ${Ne(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Nr(t){return t=(t||0)%360,t<0?t+360:t}function Ne(t){return Math.max(0,Math.min(1,t||0))}function mn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const nr=t=>()=>t;function cl(t,e){return function(n){return t+n*e}}function fl(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ul(t){return(t=+t)==1?Ui:function(e,n){return n-e?fl(e,n,t):nr(isNaN(e)?n:e)}}function Ui(t,e){var n=e-t;return n?cl(t,n):nr(isNaN(t)?e:t)}const Ye=function t(e){var n=ul(e);function r(i,a){var s=n((i=In(i)).r,(a=In(a)).r),o=n(i.g,a.g),c=n(i.b,a.b),l=Ui(i.opacity,a.opacity);return function(f){return i.r=s(f),i.g=o(f),i.b=c(f),i.opacity=l(f),i+""}}return r.gamma=t,r}(1);function hl(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function dl(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pl(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),s;for(s=0;s<r;++s)i[s]=rr(t[s],e[s]);for(;s<n;++s)a[s]=e[s];return function(o){for(s=0;s<r;++s)a[s]=i[s](o);return a}}function ml(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Nt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function gl(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=rr(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var On=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gn=new RegExp(On.source,"g");function _l(t){return function(){return t}}function wl(t){return function(e){return t(e)+""}}function Pi(t,e){var n=On.lastIndex=gn.lastIndex=0,r,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(r=On.exec(t))&&(i=gn.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),o[s]?o[s]+=a:o[++s]=a),(r=r[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:Nt(r,i)})),n=gn.lastIndex;return n<e.length&&(a=e.slice(n),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?wl(c[0].x):_l(e):(e=c.length,function(l){for(var f=0,d;f<e;++f)o[(d=c[f]).i]=d.x(l);return o.join("")})}function rr(t,e){var n=typeof e,r;return e==null||n==="boolean"?nr(e):(n==="number"?Nt:n==="string"?(r=Jt(e))?(e=r,Ye):Pi:e instanceof Jt?Ye:e instanceof Date?ml:dl(e)?hl:Array.isArray(e)?pl:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?gl:Nt)(t,e)}function yl(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Mr=180/Math.PI,Fn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qi(t,e,n,r,i,a){var s,o,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,c/=o),t*r<e*n&&(t=-t,e=-e,c=-c,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Mr,skewX:Math.atan(c)*Mr,scaleX:s,scaleY:o}}var Me;function vl(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Fn:qi(e.a,e.b,e.c,e.d,e.e,e.f)}function xl(t){return t==null||(Me||(Me=document.createElementNS("http://www.w3.org/2000/svg","g")),Me.setAttribute("transform",t),!(t=Me.transform.baseVal.consolidate()))?Fn:(t=t.matrix,qi(t.a,t.b,t.c,t.d,t.e,t.f))}function Gi(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,f,d,u,h,w){if(l!==d||f!==u){var T=h.push("translate(",null,e,null,n);w.push({i:T-4,x:Nt(l,d)},{i:T-2,x:Nt(f,u)})}else(d||u)&&h.push("translate("+d+e+u+n)}function s(l,f,d,u){l!==f?(l-f>180?f+=360:f-l>180&&(l+=360),u.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Nt(l,f)})):f&&d.push(i(d)+"rotate("+f+r)}function o(l,f,d,u){l!==f?u.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Nt(l,f)}):f&&d.push(i(d)+"skewX("+f+r)}function c(l,f,d,u,h,w){if(l!==d||f!==u){var T=h.push(i(h)+"scale(",null,",",null,")");w.push({i:T-4,x:Nt(l,d)},{i:T-2,x:Nt(f,u)})}else(d!==1||u!==1)&&h.push(i(h)+"scale("+d+","+u+")")}return function(l,f){var d=[],u=[];return l=t(l),f=t(f),a(l.translateX,l.translateY,f.translateX,f.translateY,d,u),s(l.rotate,f.rotate,d,u),o(l.skewX,f.skewX,d,u),c(l.scaleX,l.scaleY,f.scaleX,f.scaleY,d,u),l=f=null,function(h){for(var w=-1,T=u.length,$;++w<T;)d[($=u[w]).i]=$.x(h);return d.join("")}}}var bl=Gi(vl,"px, ","px)","deg)"),kl=Gi(xl,", ",")",")"),oe=0,pe=0,de=0,Wi=1e3,Ke,me,Je=0,Qt=0,ln=0,xe=typeof performance=="object"&&performance.now?performance:Date,Xi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ir(){return Qt||(Xi(Al),Qt=xe.now()+ln)}function Al(){Qt=0}function Qe(){this._call=this._time=this._next=null}Qe.prototype=Zi.prototype={constructor:Qe,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?ir():+n)+(e==null?0:+e),!this._next&&me!==this&&(me?me._next=this:Ke=this,me=this),this._call=t,this._time=n,Ln()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ln())}};function Zi(t,e,n){var r=new Qe;return r.restart(t,e,n),r}function $l(){ir(),++oe;for(var t=Ke,e;t;)(e=Qt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--oe}function Dr(){Qt=(Je=xe.now())+ln,oe=pe=0;try{$l()}finally{oe=0,Tl(),Qt=0}}function El(){var t=xe.now(),e=t-Je;e>Wi&&(ln-=e,Je=t)}function Tl(){for(var t,e=Ke,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ke=n);me=t,Ln(r)}function Ln(t){if(!oe){pe&&(pe=clearTimeout(pe));var e=t-Qt;e>24?(t<1/0&&(pe=setTimeout(Dr,t-xe.now()-ln)),de&&(de=clearInterval(de))):(de||(Je=xe.now(),de=setInterval(El,Wi)),oe=1,Xi(Dr))}}function Ir(t,e,n){var r=new Qe;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Rl=Jn("start","end","cancel","interrupt"),Sl=[],Yi=0,Or=1,Vn=2,ze=3,Fr=4,Bn=5,Ue=6;function cn(t,e,n,r,i,a){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Nl(t,n,{name:e,index:r,group:i,on:Rl,tween:Sl,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Yi})}function ar(t,e){var n=Dt(t,e);if(n.state>Yi)throw new Error("too late; already scheduled");return n}function Ft(t,e){var n=Dt(t,e);if(n.state>ze)throw new Error("too late; already running");return n}function Dt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Nl(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Zi(a,0,n.time);function a(l){n.state=Or,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var f,d,u,h;if(n.state!==Or)return c();for(f in r)if(h=r[f],h.name===n.name){if(h.state===ze)return Ir(s);h.state===Fr?(h.state=Ue,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[f]):+f<e&&(h.state=Ue,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[f])}if(Ir(function(){n.state===ze&&(n.state=Fr,n.timer.restart(o,n.delay,n.time),o(l))}),n.state=Vn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Vn){for(n.state=ze,i=new Array(u=n.tween.length),f=0,d=-1;f<u;++f)(h=n.tween[f].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function o(l){for(var f=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Bn,1),d=-1,u=i.length;++d<u;)i[d].call(t,f);n.state===Bn&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Ue,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function Ml(t,e){var n=t.__transition,r,i,a=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){a=!1;continue}i=r.state>Vn&&r.state<Bn,r.state=Ue,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}a&&delete t.__transition}}function Dl(t){return this.each(function(){Ml(this,t)})}function Il(t,e){var n,r;return function(){var i=Ft(this,t),a=i.tween;if(a!==n){r=n=a;for(var s=0,o=r.length;s<o;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Ol(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=Ft(this,t),s=a.tween;if(s!==r){i=(r=s).slice();for(var o={name:e,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===e){i[c]=o;break}c===l&&i.push(o)}a.tween=i}}function Fl(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Dt(this.node(),n).tween,i=0,a=r.length,s;i<a;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?Il:Ol)(n,t,e))}function sr(t,e,n){var r=t._id;return t.each(function(){var i=Ft(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Dt(i,r).value[e]}}function Ki(t,e){var n;return(typeof e=="number"?Nt:e instanceof Jt?Ye:(n=Jt(e))?(e=n,Ye):Pi)(t,e)}function Ll(t){return function(){this.removeAttribute(t)}}function Vl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Bl(t,e,n){var r,i=n+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===r?a:a=e(r=s,n)}}function Hl(t,e,n){var r,i=n+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?a:a=e(r=s,n)}}function Cl(t,e,n){var r,i,a;return function(){var s,o=n(this),c;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=o+"",s===c?null:s===r&&c===i?a:(i=c,a=e(r=s,o)))}}function zl(t,e,n){var r,i,a;return function(){var s,o=n(this),c;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=o+"",s===c?null:s===r&&c===i?a:(i=c,a=e(r=s,o)))}}function Ul(t,e){var n=on(t),r=n==="transform"?kl:Ki;return this.attrTween(t,typeof e=="function"?(n.local?zl:Cl)(n,r,sr(this,"attr."+t,e)):e==null?(n.local?Vl:Ll)(n):(n.local?Hl:Bl)(n,r,e))}function Pl(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ql(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Gl(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&ql(t,a)),n}return i._value=e,i}function Wl(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Pl(t,a)),n}return i._value=e,i}function Xl(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=on(t);return this.tween(n,(r.local?Gl:Wl)(r,e))}function Zl(t,e){return function(){ar(this,t).delay=+e.apply(this,arguments)}}function Yl(t,e){return e=+e,function(){ar(this,t).delay=e}}function Kl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Zl:Yl)(e,t)):Dt(this.node(),e).delay}function Jl(t,e){return function(){Ft(this,t).duration=+e.apply(this,arguments)}}function Ql(t,e){return e=+e,function(){Ft(this,t).duration=e}}function jl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Jl:Ql)(e,t)):Dt(this.node(),e).duration}function tc(t,e){if(typeof e!="function")throw new Error;return function(){Ft(this,t).ease=e}}function ec(t){var e=this._id;return arguments.length?this.each(tc(e,t)):Dt(this.node(),e).ease}function nc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Ft(this,t).ease=n}}function rc(t){if(typeof t!="function")throw new Error;return this.each(nc(this._id,t))}function ic(t){typeof t!="function"&&(t=Mi(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new Ht(r,this._parents,this._name,this._id)}function ac(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var c=e[o],l=n[o],f=c.length,d=s[o]=new Array(f),u,h=0;h<f;++h)(u=c[h]||l[h])&&(d[h]=u);for(;o<r;++o)s[o]=e[o];return new Ht(s,this._parents,this._name,this._id)}function sc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function oc(t,e,n){var r,i,a=sc(e)?ar:Ft;return function(){var s=a(this,t),o=s.on;o!==r&&(i=(r=o).copy()).on(e,n),s.on=i}}function lc(t,e){var n=this._id;return arguments.length<2?Dt(this.node(),n).on.on(t):this.each(oc(n,t,e))}function cc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function fc(){return this.on("end.remove",cc(this._id))}function uc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Qn(t));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var o=r[s],c=o.length,l=a[s]=new Array(c),f,d,u=0;u<c;++u)(f=o[u])&&(d=t.call(f,f.__data__,u,o))&&("__data__"in f&&(d.__data__=f.__data__),l[u]=d,cn(l[u],e,n,u,l,Dt(f,n)));return new Ht(a,this._parents,e,n)}function hc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ni(t));for(var r=this._groups,i=r.length,a=[],s=[],o=0;o<i;++o)for(var c=r[o],l=c.length,f,d=0;d<l;++d)if(f=c[d]){for(var u=t.call(f,f.__data__,d,c),h,w=Dt(f,n),T=0,$=u.length;T<$;++T)(h=u[T])&&cn(h,e,n,T,u,w);a.push(u),s.push(f)}return new Ht(a,s,e,n)}var dc=Kt.prototype.constructor;function pc(){return new dc(this._groups,this._parents)}function mc(t,e){var n,r,i;return function(){var a=se(this,t),s=(this.style.removeProperty(t),se(this,t));return a===s?null:a===n&&s===r?i:i=e(n=a,r=s)}}function Ji(t){return function(){this.style.removeProperty(t)}}function gc(t,e,n){var r,i=n+"",a;return function(){var s=se(this,t);return s===i?null:s===r?a:a=e(r=s,n)}}function _c(t,e,n){var r,i,a;return function(){var s=se(this,t),o=n(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(t),se(this,t))),s===c?null:s===r&&c===i?a:(i=c,a=e(r=s,o))}}function wc(t,e){var n,r,i,a="style."+e,s="end."+a,o;return function(){var c=Ft(this,t),l=c.on,f=c.value[a]==null?o||(o=Ji(e)):void 0;(l!==n||i!==f)&&(r=(n=l).copy()).on(s,i=f),c.on=r}}function yc(t,e,n){var r=(t+="")=="transform"?bl:Ki;return e==null?this.styleTween(t,mc(t,r)).on("end.style."+t,Ji(t)):typeof e=="function"?this.styleTween(t,_c(t,r,sr(this,"style."+t,e))).each(wc(this._id,t)):this.styleTween(t,gc(t,r,e),n).on("end.style."+t,null)}function vc(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function xc(t,e,n){var r,i;function a(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&vc(t,s,n)),r}return a._value=e,a}function bc(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,xc(t,e,n??""))}function kc(t){return function(){this.textContent=t}}function Ac(t){return function(){var e=t(this);this.textContent=e??""}}function $c(t){return this.tween("text",typeof t=="function"?Ac(sr(this,"text",t)):kc(t==null?"":t+""))}function Ec(t){return function(e){this.textContent=t.call(this,e)}}function Tc(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Ec(i)),e}return r._value=t,r}function Rc(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Tc(t))}function Sc(){for(var t=this._name,e=this._id,n=Qi(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,c,l=0;l<o;++l)if(c=s[l]){var f=Dt(c,e);cn(c,t,n,l,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Ht(r,this._parents,t,n)}function Nc(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,s){var o={value:s},c={value:function(){--i===0&&a()}};n.each(function(){var l=Ft(this,r),f=l.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(c)),l.on=e}),i===0&&a()})}var Mc=0;function Ht(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Qi(){return++Mc}var Lt=Kt.prototype;Ht.prototype={constructor:Ht,select:uc,selectAll:hc,selectChild:Lt.selectChild,selectChildren:Lt.selectChildren,filter:ic,merge:ac,selection:pc,transition:Sc,call:Lt.call,nodes:Lt.nodes,node:Lt.node,size:Lt.size,empty:Lt.empty,each:Lt.each,on:lc,attr:Ul,attrTween:Xl,style:yc,styleTween:bc,text:$c,textTween:Rc,remove:fc,tween:Fl,delay:Kl,duration:jl,ease:ec,easeVarying:rc,end:Nc,[Symbol.iterator]:Lt[Symbol.iterator]};function Dc(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ic={time:null,delay:0,duration:250,ease:Dc};function Oc(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Fc(t){var e,n;t instanceof Ht?(e=t._id,t=t._name):(e=Qi(),(n=Ic).time=ir(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&cn(c,t,e,l,s,n||Oc(c,e));return new Ht(r,this._parents,t,e)}Kt.prototype.interrupt=Dl;Kt.prototype.transition=Fc;const Hn=Math.PI,Cn=2*Hn,Gt=1e-6,Lc=Cn-Gt;function ji(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Vc(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return ji;const n=10**e;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Bc{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?ji:Vc(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,a,s){this._append`C${+e},${+n},${+r},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,n,r,i,a){if(e=+e,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,c=r-e,l=i-n,f=s-e,d=o-n,u=f*f+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(u>Gt)if(!(Math.abs(d*c-l*f)>Gt)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-s,w=i-o,T=c*c+l*l,$=h*h+w*w,k=Math.sqrt(T),g=Math.sqrt(u),_=a*Math.tan((Hn-Math.acos((T+u-$)/(2*k*g)))/2),p=_/g,v=_/k;Math.abs(p-1)>Gt&&this._append`L${e+p*f},${n+p*d}`,this._append`A${a},${a},0,0,${+(d*h>f*w)},${this._x1=e+v*c},${this._y1=n+v*l}`}}arc(e,n,r,i,a,s){if(e=+e,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),c=r*Math.sin(i),l=e+o,f=n+c,d=1^s,u=s?i-a:a-i;this._x1===null?this._append`M${l},${f}`:(Math.abs(this._x1-l)>Gt||Math.abs(this._y1-f)>Gt)&&this._append`L${l},${f}`,r&&(u<0&&(u=u%Cn+Cn),u>Lc?this._append`A${r},${r},0,1,${d},${e-o},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=f}`:u>Gt&&this._append`A${r},${r},0,${+(u>=Hn)},${d},${this._x1=e+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Hc(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function je(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function le(t){return t=je(Math.abs(t)),t?t[1]:NaN}function Cc(t,e){return function(n,r){for(var i=n.length,a=[],s=0,o=t[0],c=0;i>0&&o>0&&(c+o+1>r&&(o=Math.max(1,r-c)),a.push(n.substring(i-=o,i+o)),!((c+=o+1)>r));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function zc(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Uc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tn(t){if(!(e=Uc.exec(t)))throw new Error("invalid format: "+t);var e;return new or({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}tn.prototype=or.prototype;function or(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}or.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Pc(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ta;function qc(t,e){var n=je(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(ta=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return a===s?r:a>s?r+new Array(a-s+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+je(t,Math.max(0,e+a-1))[0]}function Lr(t,e){var n=je(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Vr={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Hc,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Lr(t*100,e),r:Lr,s:qc,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Br(t){return t}var Hr=Array.prototype.map,Cr=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Gc(t){var e=t.grouping===void 0||t.thousands===void 0?Br:Cc(Hr.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Br:zc(Hr.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(d){d=tn(d);var u=d.fill,h=d.align,w=d.sign,T=d.symbol,$=d.zero,k=d.width,g=d.comma,_=d.precision,p=d.trim,v=d.type;v==="n"?(g=!0,v="g"):Vr[v]||(_===void 0&&(_=12),p=!0,v="g"),($||u==="0"&&h==="=")&&($=!0,u="0",h="=");var E=T==="$"?n:T==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",y=T==="$"?r:/[%p]/.test(v)?s:"",A=Vr[v],x=/[defgprs%]/.test(v);_=_===void 0?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function b(m){var N=E,V=y,C,W,M;if(v==="c")V=A(m)+V,m="";else{m=+m;var et=m<0||1/m<0;if(m=isNaN(m)?c:A(Math.abs(m),_),p&&(m=Pc(m)),et&&+m==0&&w!=="+"&&(et=!1),N=(et?w==="("?w:o:w==="-"||w==="("?"":w)+N,V=(v==="s"?Cr[8+ta/3]:"")+V+(et&&w==="("?")":""),x){for(C=-1,W=m.length;++C<W;)if(M=m.charCodeAt(C),48>M||M>57){V=(M===46?i+m.slice(C+1):m.slice(C))+V,m=m.slice(0,C);break}}}g&&!$&&(m=e(m,1/0));var ot=N.length+m.length+V.length,S=ot<k?new Array(k-ot+1).join(u):"";switch(g&&$&&(m=e(S+m,S.length?k-V.length:1/0),S=""),h){case"<":m=N+m+V+S;break;case"=":m=N+S+m+V;break;case"^":m=S.slice(0,ot=S.length>>1)+N+m+V+S.slice(ot);break;default:m=S+N+m+V;break}return a(m)}return b.toString=function(){return d+""},b}function f(d,u){var h=l((d=tn(d),d.type="f",d)),w=Math.max(-8,Math.min(8,Math.floor(le(u)/3)))*3,T=Math.pow(10,-w),$=Cr[8+w/3];return function(k){return h(T*k)+$}}return{format:l,formatPrefix:f}}var De,ea,na;Wc({thousands:",",grouping:[3],currency:["$",""]});function Wc(t){return De=Gc(t),ea=De.format,na=De.formatPrefix,De}function Xc(t){return Math.max(0,-le(Math.abs(t)))}function Zc(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(le(e)/3)))*3-le(Math.abs(t)))}function Yc(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,le(e)-le(t))+1}function Kc(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Jc(t){return function(){return t}}function Qc(t){return+t}var zr=[0,1];function re(t){return t}function zn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Jc(isNaN(e)?NaN:.5)}function jc(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function tf(t,e,n){var r=t[0],i=t[1],a=e[0],s=e[1];return i<r?(r=zn(i,r),a=n(s,a)):(r=zn(r,i),a=n(a,s)),function(o){return a(r(o))}}function ef(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=zn(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(o){var c=Za(t,o,1,r)-1;return a[c](i[c](o))}}function nf(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function rf(){var t=zr,e=zr,n=rr,r,i,a,s=re,o,c,l;function f(){var u=Math.min(t.length,e.length);return s!==re&&(s=jc(t[0],t[u-1])),o=u>2?ef:tf,c=l=null,d}function d(u){return u==null||isNaN(u=+u)?a:(c||(c=o(t.map(r),e,n)))(r(s(u)))}return d.invert=function(u){return s(i((l||(l=o(e,t.map(r),Nt)))(u)))},d.domain=function(u){return arguments.length?(t=Array.from(u,Qc),f()):t.slice()},d.range=function(u){return arguments.length?(e=Array.from(u),f()):e.slice()},d.rangeRound=function(u){return e=Array.from(u),n=yl,f()},d.clamp=function(u){return arguments.length?(s=u?!0:re,f()):s!==re},d.interpolate=function(u){return arguments.length?(n=u,f()):n},d.unknown=function(u){return arguments.length?(a=u,d):a},function(u,h){return r=u,i=h,f()}}function af(){return rf()(re,re)}function sf(t,e,n,r){var i=ja(t,e,n),a;switch(r=tn(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=Zc(i,s))&&(r.precision=a),na(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Yc(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Xc(i))&&(r.precision=a-(r.type==="%")*2);break}}return ea(r)}function of(t){var e=t.domain;return t.ticks=function(n){var r=e();return Qa(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return sf(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,s=r[i],o=r[a],c,l,f=10;for(o<s&&(l=s,s=o,o=l,l=i,i=a,a=l);f-- >0;){if(l=Sn(s,o,n),l===c)return r[i]=s,r[a]=o,e(r);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;c=l}return t},t}function zt(){var t=af();return t.copy=function(){return nf(t,zt())},Kc.apply(t,arguments),of(t)}function Ie(t){return function(){return t}}const lr=Math.sqrt,ra=Math.PI,lf=2*ra;function cf(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Bc(e)}const ff={draw(t,e){const n=lr(e/ra);t.moveTo(n,0),t.arc(0,0,n,0,lf)}},_n=lr(3),ia={draw(t,e){const n=-lr(e/(_n*3));t.moveTo(0,n*2),t.lineTo(-_n*n,-n),t.lineTo(_n*n,-n),t.closePath()}};function aa(t,e){let n=null,r=cf(i);t=typeof t=="function"?t:Ie(t||ff),e=typeof e=="function"?e:Ie(e===void 0?64:+e);function i(){let a;if(n||(n=a=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),a)return n=null,a+""||null}return i.type=function(a){return arguments.length?(t=typeof a=="function"?a:Ie(a),i):t},i.size=function(a){return arguments.length?(e=typeof a=="function"?a:Ie(+a),i):e},i.context=function(a){return arguments.length?(n=a??null,i):n},i}function ge(t,e,n){this.k=t,this.x=e,this.y=n}ge.prototype={constructor:ge,scale:function(t){return t===1?this:new ge(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ge(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ge.prototype;function cr(t,e,n){var r,i,a;if(t.length==0)r=1;else{for(var s=1;s<t.length;s++){for(const l of t[s]){var[o,c]=l.split(":");if(n<o||e>c)a=1;else{a=0;break}}if(a){i=1,r=s;break}}i||(r=t.length)}return r}function sa(t,e){let n=-1,r=-1;for(let i in t){let s=t[i].children;s&&s.forEach(o=>{e.indexOf(o.type)>=0&&((n<0||o.fmin<n)&&(n=o.fmin),(r<0||o.fmax>r)&&(r=o.fmax))})}return{fmin:n,fmax:r}}function ce(t){let n=t.attr("class").split(" "),r=`.${n[0]}.${n[1]} .track`,i=Rt(r).nodes(),a=0;return i.forEach(s=>{a+=s.getBoundingClientRect().height+1}),a}function uf(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"transform",t);var n=e.transform.baseVal.consolidate().matrix;return[n.e,n.f]}function oa(t,e){let n=e.node().getBBox().height;e.selectAll(".variant-deletion,.variant-SNV,.variant-insertion,.variant-delins").filter(i=>{let a=!1;return i.alleles&&(i.alleles[0].replace(/"|\[|\]| /g,"").split(",").forEach(o=>{t.includes(o)&&(a=!0)}),i.alleles.forEach(o=>{t.includes(o)&&(a=!0)})),a}).datum(i=>(i.selected="true",i)).style("stroke","black").each(function(){let i=G(this).attr("x"),a=G(this).attr("width");a==null&&(a=3,i=i-a/2),e.select(".deletions.track").append("rect").attr("class","highlight").attr("x",i).attr("width",a).attr("height",n).attr("fill","yellow").attr("opacity",.8).lower()})}class fr{async fetchDataFromUrl(e,n){const r=`${e.chromosome}:${e.start}..${e.end}`,i=e[n],a=i[0]+encodeURI(e.genome)+i[1]+encodeURI(r)+i[2],s=await fetch(a);return s.ok?s.json():[]}}function hf(t){return t===1?"+":t===-1?"-":t}function ft(t){let e="";return e+='<table class="tooltip-table" style="margin-top: 30px;"><tbody>',t.id.indexOf("http")<0?e+=`<tr><th>Name</th><td>${t.name} (${t.id})</td></tr>`:e+=`<tr><th>Name</th><td>${t.name}</td></tr>`,e+=`<tr><th>Type</th><td>${t.type}</td></tr>`,e+=`<tr><th>Source</th><td>${t.source}</td></tr>`,e+=`<tr><th>Location</th><td>${t.seqId}:${t.fmin}..${t.fmax} (${hf(t.strand)})</td></tr>`,e+="</tbody></table>",e}function la(t,e,n,r){let i="";if(t==="FlyBase")i=`https://alliancegenome.org/jbrowse/?data=data%2FDrosophila%20melanogaster&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="MGI")i=`https://alliancegenome.org/jbrowse/?data=data%2FMus%20musculus&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="WormBase")i=`https://alliancegenome.org/jbrowse/?data=data%2FCaenorhabditis%20elegans&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="ZFIN")i=`https://alliancegenome.org/jbrowse/?data=data%2FDanio%20rerio&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="SGD")i=`https://alliancegenome.org/jbrowse/?data=data%2FSaccharomyces%20cerevisiae&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="RGD")i=`https://alliancegenome.org/jbrowse/?data=data%2FRattus%20norvegicus&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="human")i=`https://alliancegenome.org/jbrowse/?data=data%2FHomo%20sapiens&tracks=All%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else return console.warn("no source found",t),"Maximum features displayed.  See full view for more.";return`<a href="${i}">Maximum features displayed.  See full view for more.</a>`}const Pe=Object.freeze({transcript_ablation:{impact:"HIGH",color:"#ff0000"},splice_acceptor_variant:{impact:"HIGH",color:"#ff581a"},splice_donor_variant:{impact:"HIGH",color:"#ff581a"},stop_gained:{impact:"HIGH",color:"#ff0000"},frameshift_variant:{impact:"HIGH",color:"#9400D3"},stop_lost:{impact:"HIGH",color:"#ff0000"},start_lost:{impact:"HIGH",color:"#ffd700"},transcript_amplification:{impact:"HIGH",color:"#ff69b4"},inframe_insertion:{impact:"MODERATE",color:"#ff69b4"},inframe_deletion:{impact:"MODERATE",color:"#ff69b4"},missense_variant:{impact:"MODERATE",color:"#ffd700"},protein_altering_variant:{impact:"MODERATE",color:"#ff0080"},splice_region_variant:{impact:"LOW",color:"#ff7f50"},incomplete_terminal_codon_variant:{impact:"LOW",color:"#ff00ff"},start_retained_variant:{impact:"LOW",color:"#76ee00"},stop_retained_variant:{impact:"LOW",color:"#76ee00"},synonymous_variant:{impact:"LOW",color:"#76ee00"},coding_sequence_variant:{impact:"MODIFIER",color:"#458b00"},mature_miRNA_variant:{impact:"MODIFIER",color:"#458b00"},five_prime_UTR_variant:{impact:"MODIFIER",color:"#7ac5cd"},three_prime_UTR_variant:{impact:"MODIFIER",color:"#7ac5cd"},non_coding_transcript_exon_variant:{impact:"MODIFIER",color:"#32cd32"},intron_variant:{impact:"MODIFIER",color:"#02599c"},NMD_transcript_variant:{impact:"MODIFIER",color:"#ff4500"},non_coding_transcript_variant:{impact:"MODIFIER",color:"#32cd32"},upstream_gene_variant:{impact:"MODIFIER",color:"#a2b5cd"},downstream_gene_variant:{impact:"MODIFIER",color:"#a2b5cd"},TFBS_ablation:{impact:"MODIFIER",color:"#a52a2a"},TFBS_amplification:{impact:"MODIFIER",color:"#a52a2a"},TF_binding_site_variant:{impact:"MODIFIER",color:"#a52a2a"},regulatory_region_ablation:{impact:"MODERATE",color:"#a52a2a"},regulatory_region_amplification:{impact:"MODIFIER",color:"#a52a2a"},feature_elongation:{impact:"MODIFIER",color:"#7f7f7f"},regulatory_region_variant:{impact:"MODIFIER",color:"#a52a2a"},feature_truncation:{impact:"MODIFIER",color:"#7f7f7f"},intergenic_variant:{impact:"MODIFIER",color:"#636363"}});function df(t){if(!t)return"black";if(t.split(" ").length>1)return"hotpink";if(t==="UNKNOWN")return"gray";const e=Pe[t];if(e)return e.color;if(t==="5_prime_UTR_variant")return Pe.five_prime_UTR_variant.color;if(t==="3_prime_UTR_variant")return Pe.three_prime_UTR_variant.color;console.warn("Consequence ",t,"not found")}const Zt=10,Ct=10;function ur(t){return`${t},${Zt} ${t+Ct/2},${Zt/2} ${t},0 ${t-Ct/2},${Zt/2}`}function ca(t){return`${t-Ct/2},${Zt} ${t},0 ${t+Ct/2},${Zt}`}function pf(t,e,n){if(t.length==0)return 0;{let r=!0,i=0;return t.sort((a,s)=>a.row>s.row?1:-1),t.every(a=>i!=a.row&&r?!1:(i!=a.row&&(i=a.row,r=!0),a.fmin>e&&a.fmin>n||a.fmax<n&&a.fmax<e||(r=!1),!0)),r?i:i+1}}function fa(t){return`${t-Ct/2},${Zt} ${t+Ct/2},${Zt} ${t-Ct/2},0 ${t+Ct/2},0`}function mf(t){const e=Object.keys(t).length;return{descriptionWidth:Object.entries(t).filter(r=>r[1]!==void 0).sort((r,i)=>i[1].length-r[1].length)[0][1].length,descriptionHeight:e}}function gf(t,e,n){let{fmax:r,fmin:i,type:a}=e;return t.findIndex(s=>{const o=s.fmin+n,c=s.fmax-n;return a!==s.type?!1:o<=i&&c>=i||c<=r&&c>=r||o>=i&&c<=r})}function _f(t){let e=[];return t.forEach(n=>{let r=hr(n),{type:i,fmax:a,fmin:s}=n,o=e.findIndex(c=>{const l=c.fmin,f=c.fmax;return c.type!==i||c.consequence!==r?!1:l<=s&&f>=s||f<=a&&f>=a||l>=s&&f<=a});if(o>=0){let c=e[o];const l=e[o].variantSet?e[o].variantSet.findIndex(f=>f.type===i&&f.consequence===r):-1;l>=0?e[l].variantSet.push(n):e[o].variantSet=[{variants:[n],type:i,consequence:r}],c.variants.push(n),c.fmin=Math.min(s,c.fmin),c.fmax=Math.max(a,c.fmax),e[o]=c}else{const c={fmin:s,fmax:a,type:i,consequence:r,variantSet:[{variants:[n],type:i,consequence:r}],variants:[n]};e.push(c)}}),e}function ua(t,e){let n=[];return t.forEach(r=>{let i=hr(r),{type:a,fmax:s,fmin:o}=r,c=gf(n,r,e);if(c>=0&&a!="deletion"){let l=n[c];const f=l.variantSet?l.variantSet.findIndex(d=>d.type===a&&d.consequence===i):-1;if(f>=0){let d=Math.min(l.variantSet[f].fmin,o),u=Math.max(l.variantSet[f].fmax,s);l.fmin=d,l.fmax=u,l.variantSet[f].fmin=d,l.variantSet[f].fmax=u,l.variantSet[f].variants.push(r)}else{let d=Math.min(l.fmin,o),u=Math.max(l.fmax,s);l.fmin=d,l.fmax=u,l.variantSet.push({variants:[r],type:a,consequence:i,fmin:o,fmax:s})}l.variants.push(r),l.fmin=Math.min(o,l.fmin),l.fmax=Math.max(s,l.fmax),n[c]=l}else{const l={fmin:o,fmax:s,type:a,consequence:i,variantSet:[{variants:[r],type:a,consequence:i,fmin:o,fmax:s}],variants:[r]};n.push(l)}}),n}function Un(t){if(t.length===1){let e='<div style="margin-top: 30px;">';return e+=Ur(t[0]),e+="</div>",e}else if(t.length>1){let e='<ul style="list-style-type: none; margin-top: 30px;">';for(let n of t)e+=`<li style="border-bottom: solid 1px black;">${Ur(n)}</li>`;return e+="</ul>",e}else return"No data available"}function Ur(t){let{descriptionWidth:e}=mf(t),n="";const r=t.location,[i,a]=r.split(":")[1].split("..");let s=t.alternative_alleles,o=t.reference_allele,c;if(t.type==="SNV")c="1bp";else if(t.type==="deletion")c=`${o.length-1}bp deleted`;else if(t.type==="insertion")s==="ALT_MISSING"?(c="unknown length inserted",s="n+"):c=`${s.length-1}bp inserted`;else if(t.type==="MNV")c=`${o.length}bp`;else if(t.type==="delins"){let f=`${o.length-1}bp deleted`,d;s==="ALT_MISSING"?(d="unknown length inserted",s="n+"):d=`${s.length-1}bp inserted`,c=`${f}; ${d}`}else c=`${a-i}bp`;o.length>20?o=`${o.substring(0,1).toLowerCase()+o.substring(1,8).toUpperCase()}...${o.substring(o.length-8).toUpperCase()}`:o=o.substring(0,1).toLowerCase()+o.substring(1).toUpperCase(),s.length>20?s=`${s.substring(0,1).toLowerCase()+s.substring(1,8).toUpperCase()}...${s.substring(s.length-8).toUpperCase()}`:s=s.substring(0,1).toLowerCase()+s.substring(1).toUpperCase(),(t.type==="SNV"||t.type==="MNV")&&(s=s.toUpperCase(),o=o.toUpperCase());let l="";return t.type==="insertion"?l=`ins: ${s}`:t.type==="deletion"?l=`del: ${o}`:l=`${o}->${s}`,n+='<table class="tooltip-table"><tbody>',n+=`<tr><th>Symbol</th><td>${t.symbolDetail}</td></tr>`,n+=`<tr><th>Type</th><td>${t.type}</td></tr>`,n+=`<tr><th>Consequence</th><td>${t.consequence}</td></tr>`,t.impact&&(n+=`<tr><th>Impact</th><td>${t.impact.length>e?t.impact.substr(0,e):t.impact}</td></tr>`),n+=`<tr><th>Length</th><td>${c}</td></tr>`,t.name!==t.symbol&&(n+=`<tr><th>Name</th><td>${t.name}</td></tr>`),t.geneId&&t.geneSymbol?n+=`<tr><th>Allele of Genes</th><td> ${t.geneSymbol>e?t.geneSymbol.substr(0,e):t.geneSymbol} (${t.geneId})</td></tr>`:t.allele_of_genes&&(n+=`<tr><th>Allele of Genes</th><td>${t.allele_of_genes.length>e?t.allele_of_genes.substr(0,e):t.allele_of_genes}</td></tr>`),t.alternative_alleles&&(n+=`<tr><th>Sequence Change</th><td>${l}</td></tr>`),n+="</tbody></table>",n}function Pn(t){return t.variants.map(e=>{let n=wf(e);return n.consequence=n.consequence?n.consequence:"UNKNOWN",n})}function Pr(t){let e=[];return t.variants.forEach(n=>{let r=n.allele_ids.values[0].replace(/"/g,"");r.split(",").length>1?r.split(",").forEach(i=>{e.push(i.replace(/\[|\]| /g,""))}):e.push(r)}),e}function qn(t){return t.map(e=>df(e.consequence))}function hr(t){var n;let e="UNKNOWN";return(n=t.geneLevelConsequence)!=null&&n.values&&t.geneLevelConsequence.values.length>0&&(e=t.geneLevelConsequence.values[0].replace(/\|/g," ").replace(/"/g,"")),e}function wf(t){let e={};return e.symbol=be(t),e.symbolDetail=ha(t),e.location=`${t.seqId}:${t.fmin}..${t.fmax}`,e.consequence=hr(t),e.type=t.type,e.name=t.name,e.description=t.description,e.reference_allele=t.reference_allele,e.geneId=t.allele_of_gene_ids?t.allele_of_gene_ids.values[0].replace(/"/g,""):void 0,e.geneSymbol=t.allele_of_gene_symbols?t.allele_of_gene_symbols.values[0].replace(/"/g,""):void 0,t.allele_of_genes&&(t.allele_of_genes.values&&t.allele_of_genes.values.length>0?e.allele_of_genes=(Array.isArray(t.allele_of_genes.values)?t.allele_of_genes.values.join(" "):t.allele_of_genes.values).replace(/"/g,""):e.allele_of_genes=t.allele_of_genes),t.allele_ids&&(t.allele_ids.values&&t.allele_ids.values.length>0?e.allele_ids=(Array.isArray(t.allele_ids.values)?t.allele_ids.values.join(" "):t.allele_ids.values).replace(/"/g,""):e.allele_ids=t.allele_ids),t.alternative_alleles&&(t.alternative_alleles.values&&t.alternative_alleles.values.length>0?e.alternative_alleles=(Array.isArray(t.alternative_alleles.values)?t.alternative_alleles.values.join(" "):t.alternative_alleles.values).replace(/"/g,""):e.alternative_alleles=t.alternative_alleles),t.impact&&(t.impact.values&&t.impact.values.length>0?e.impact=(Array.isArray(t.impact.values)?t.impact.values.join(" "):t.impact.values).replace(/"/g,""):e.impact=t.impact),e}function ha(t){var e;if(t.variants)return t.variants.length!==1?t.variants.length:ha(t.variants[0]);if((e=t.allele_symbols)!=null&&e.values)if(t.allele_symbols.values[0].split(",").length>1)try{let n=[];const r=t.allele_symbols.values[0].replace(/"|\[|\]/g,""),i=t.allele_ids.values[0].replace(/"|\[|\]/g,""),a=r.split(","),s=i.split(",");for(let o in r.split(",")){const c=`${a[o].trim()} (${s[o].trim()})`;n.push(c)}return n.join(", ")}catch(n){return console.error(n),t.allele_symbols.values[0].split(",").length}else return`${t.allele_symbols.values[0].replace(/"/g,"")}(${t.allele_ids.values[0].replace(/"|\[|\]/g,"")})`}function be(t){var e;if(t.variants)return t.variants.length!==1?t.variants.length:be(t.variants[0]);if((e=t.allele_symbols_text)!=null&&e.values)return t.allele_symbols_text.values[0].split(",").length>1?t.allele_symbols_text.values[0].split(",").length:t.allele_symbols_text.values[0].replace(/"/g,"")}function yf(t){let e=[];for(var n of t)n.type.toLowerCase()==="deletion"||(n.type.toLowerCase()==="snv"||n.type.toLowerCase()==="point_mutation"?e.push("snv"):n.type.toLowerCase()==="insertion"?e.push("insertion"):(n.type.toLowerCase()==="delins"||n.type.toLowerCase()==="substitution"||n.type.toLowerCase()==="indel"||n.type.toLowerCase()==="mnv")&&e.push("delins"));return[...new Set(e)].sort()}let vf=new fr;class xf{constructor({viewer:e,height:n,width:r,transcriptTypes:i,variantTypes:a,showVariantLabel:s,variantFilter:o,binRatio:c,isoformFilter:l,initialHiglight:f,service:d}){this.trackData={},this.variantData={},this.viewer=e,this.width=r,this.variantFilter=o,this.isoformFilter=l,this.initialHighlight=f,this.height=n,this.transcriptTypes=i,this.variantTypes=a,this.binRatio=c,this.showVariantLabel=s!==void 0?s:!0,this.service=d||vf}DrawTrack(){let e=this.isoformFilter,n=this.trackData,r=this.initialHighlight,i=this.filterVariantData(this.variantData,this.variantFilter),a=this.viewer,s=this.width,o=this.binRatio,c=yf(i),l=c.length,f=this.trackData[0].source,d=this.trackData[0].seqId,u=e.length===0?9:30,h=["UTR","five_prime_UTR","three_prime_UTR"],w=["CDS"],T=["exon"],$=this.transcriptTypes,k=sa(n,$),g=k.fmin,_=k.fmax;const p=10,v=10,E=40,y=20,A=2,x=0,b=10,m=10,N=4,V=20,C=10,W=`0,0 0,${V} ${C},${C}`,M=10,et=40,ot=22.5;let S=zt().domain([g,_]).range([0,s]),Z=a.append("g").attr("class","deletions track").attr("transform","translate(0,22.5)"),K=a.append("g").attr("class","label"),nt={};for(let B=0,R=h.length;B<R;B++)nt[h[B]]=200;for(let B=0,R=w.length;B<R;B++)nt[w[B]]=1e3;for(let B=0,R=T.length;B<R;B++)nt[T[B]]=100;let ht={};n=n.sort((B,R)=>B.selected&&!R.selected?-1:!B.selected&&R.selected?1:B.name-R.name);let I=0,Q=G("body").append("div").attr("class","gfc-tooltip").style("visibility","visible").style("opacity",0);const st=()=>{Q.transition().duration(100).style("opacity",10).style("visibility","hidden")};let gt=ua(i,(_-g)*o),dt=gt.filter(B=>B.type=="deletion"),H=gt.filter(B=>B.type!=="deletion"),tt=[];dt.forEach(B=>{let{fmax:R,fmin:J}=B,P=this.width,mt=be(B);const D=Pn(B);let ct=Pr(B),rt=Un(D);const X=qn(D)[0];let kt=pf(tt,J,R);tt.push({fmin:J,fmax:R,row:kt});const Et=Math.ceil(S(R)-S(J))<A?A:Math.ceil(S(R)-S(J));Z.append("rect").attr("class","variant-deletion").attr("id",`variant-${J}`).attr("x",S(J)).attr("transform",`translate(0,${m*kt})`).attr("z-index",30).attr("fill",X).attr("height",m).attr("width",Et).on("click",()=>{j(Q,rt,st)}).on("mouseover",Y=>{let q=Y.variant;Rt(".variant-deletion").filter(it=>it.variant===q).style("stroke","black"),G(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(it=>it.variant===q).style("opacity",1)}).on("mouseout",()=>{Rt(".variant-deletion").filter(Y=>Y.selected!="true").style("stroke",null),G(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:J,fmax:R,variant:mt+J,alleles:ct});{let Y=0;Y=S(J);let q=m*l+ot,it=K.append("text").attr("class","variantLabel").attr("fill",X).attr("opacity",0).attr("height",x).attr("transform",`translate(${Y},${q})`).text(mt).on("click",()=>{j(Q,rt,st)}).datum({fmin:J,variant:mt+J}),L=it.node().getBBox().width;if(parseFloat(L+Y)>P){let At=parseFloat(L+Y-P);Y-=At,it.attr("transform",`translate(${Y},${q})`)}}});let xt=ce(this.viewer),bt=a.append("g").attr("class","variants track").attr("transform",`translate(0,${xt})`);H.forEach(B=>{let{type:R,fmax:J,fmin:P}=B,mt=!0,D=!1,ct=this.width,rt=be(B);const X=Pn(B);let kt=Pr(B),Et=Un(X);const Y=qn(X)[0];if(R.toLowerCase()==="snv"||R.toLowerCase()==="point_mutation"?(D=!0,bt.append("polygon").attr("class","variant-SNV").attr("id",`variant-${P}`).attr("points",ur(S(P))).attr("fill",Y).attr("x",S(P)).attr("transform",`translate(0,${m*c.indexOf("snv")})`).attr("z-index",30).on("click",()=>{j(Q,Et,st)}).on("mouseover",function(q){let it=q.variant;Rt(".variant-SNV").filter(function(L){return L.variant===it}).style("stroke","black"),G(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(L=>L.variant===it).style("opacity",1)}).on("mouseout",()=>{Rt(".variant-SNV").filter(q=>q.selected!="true").style("stroke",null),G(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:P,fmax:J,variant:rt+P,alleles:kt})):R.toLowerCase()==="insertion"?(D=!0,bt.append("polygon").attr("class","variant-insertion").attr("id",`variant-${P}`).attr("points",ca(S(P))).attr("fill",Y).attr("x",S(P)).attr("transform",`translate(0,${m*c.indexOf("insertion")})`).attr("z-index",30).on("click",()=>{j(Q,Et,st)}).on("mouseover",q=>{let it=q.variant;Rt(".variant-insertion").filter(L=>L.variant===it).style("stroke","black"),G(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(L=>L.variant===it).style("opacity",1)}).on("mouseout",()=>{Rt(".variant-insertion").filter(q=>q.selected!="true").style("stroke",null),G(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:P,fmax:J,variant:rt+P,alleles:kt})):R.toLowerCase()==="delins"||R.toLowerCase()==="substitution"||R.toLowerCase()==="indel"||R.toLowerCase()==="mnv"?(D=!0,bt.append("polygon").attr("class","variant-delins").attr("id",`variant-${P}`).attr("points",fa(S(P))).attr("x",S(P)).attr("transform",`translate(0,${m*c.indexOf("delins")})`).attr("fill",Y).attr("z-index",30).on("click",()=>{j(Q,Et,st)}).on("mouseover",q=>{let it=q.variant;Rt(".variant-delins").filter(L=>L.variant===it).style("stroke","black"),G(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(L=>L.variant===it).style("opacity",1)}).on("mouseout",()=>{Rt(".variant-delins").filter(q=>q.selected!="true").style("stroke",null),G(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:P,fmax:J,variant:rt+P,alleles:kt})):(console.warn("type not found",R,B),mt=!1),mt){let q=0;D?q=S(P)-M/2:q=S(P);let it=m*l+ot,L=K.append("text").attr("class","variantLabel").attr("fill",Y).attr("opacity",0).attr("height",x).attr("transform",`translate(${q},${it})`).text(rt).on("click",()=>{j(Q,Et,st)}).datum({fmin:P,variant:rt+P}),At=L.node().getBBox().width;if(parseFloat(At+q)>ct){let ee=parseFloat(At+q-ct);q-=ee,L.attr("transform",`translate(${q},35)`)}}});let Ut=xt;K.attr("transform",`translate(0,${Ut})`);let F=ce(this.viewer)+ot,yt=a.append("g").attr("transform",`translate(0,${F})`).attr("class","track"),z=0,pt=[],ut=-1,_t=-1,j=this.renderTooltipDescription,Pt=[];for(let B=0;B<n.length&&z<u;B++){let R=n[B],J=R.children;if(J){let P=R.selected;J=J.sort(function(D,ct){return D.name<ct.name?-1:D.name>ct.name?1:D-ct});let mt=!1;J.forEach(function(D){if(!(e.indexOf(D.id)>=0||e.indexOf(D.name)>=0)&&e.length!==0||Pt.includes(D.id))return;Pt.push(D.id);let ct=D.type;if($.indexOf(ct)>=0){let rt=cr(pt,S(D.fmin),S(D.fmax));if(z<u){let X,kt,Et=!1;Object.keys(ht).includes(R.name)||(I+=y,Et=!0,ht[R.name]="Green");let Y=yt.append("g").attr("class","isoform").attr("transform",`translate(0,${z*E+10+I})`);Et&&(X=R.name,kt=Y.append("text").attr("class","geneLabel").attr("fill",P?"sandybrown":"black").attr("height",x).attr("transform",`translate(${S(D.fmin)},-${y})`).text(X).on("click",()=>{j(Q,ft(R),st)}).datum({fmin:D.fmin})),Y.append("polygon").datum(()=>({fmin:D.fmin,fmax:D.fmax,strand:R.strand})).attr("class","transArrow").attr("points",W).attr("transform",L=>R.strand>0?`translate(${Number(S(L.fmax))},0)`:`translate(${Number(S(L.fmin))},${V}) rotate(180)`).on("click",()=>{j(Q,ft(D),st)}),Y.append("rect").attr("class","transcriptBackbone").attr("y",10+x).attr("height",N).attr("transform",`translate(${S(D.fmin)},0)`).attr("width",S(D.fmax)-S(D.fmin)).on("click",()=>{j(Q,ft(D),st)}).datum({fmin:D.fmin,fmax:D.fmax}),X=D.name,kt=Y.append("text").attr("class","transcriptLabel").attr("fill",P?"sandybrown":"gray").attr("opacity",P?1:.5).attr("height",x).attr("transform",`translate(${S(D.fmin)},0)`).text(X).on("click",()=>{j(Q,ft(D),st)}).datum({fmin:D.fmin});let q=X.length*2,it;try{q=kt.node().getBBox().width}catch{}if(Number(q+S(D.fmin))>s,q>S(D.fmax)-S(D.fmin)?it=S(D.fmin)+q:it=S(D.fmax),pt[rt]){let L=pt[rt];L.push(`${S(D.fmin)}:${it}`),pt[rt]=L}else pt[rt]=[`${S(D.fmin)}:${it}`];(ut<0||ut>D.fmin)&&(ut=D.fmin),(_t<0||_t<D.fmax)&&(_t=D.fmax),D.children&&(D.children=D.children.sort((L,At)=>{let ee=nt[L.type],Ee=nt[At.type];return typeof ee=="number"&&typeof Ee=="number"?ee-Ee:typeof ee=="number"&&typeof Ee!="number"?-1:typeof ee!="number"&&typeof Ee=="number"?1:L.type-At.type}),D.children.forEach(L=>{let At=L.type;T.includes(At)?Y.append("rect").attr("class","exon").attr("x",S(L.fmin)).attr("transform",`translate(0,${p-N})`).attr("height",p).attr("z-index",10).attr("width",S(L.fmax)-S(L.fmin)).on("click",()=>{j(Q,ft(D),st)}).datum({fmin:L.fmin,fmax:L.fmax}):w.includes(At)?Y.append("rect").attr("class","CDS").attr("x",S(L.fmin)).attr("transform",`translate(0,${v-N})`).attr("z-index",20).attr("height",v).attr("width",S(L.fmax)-S(L.fmin)).on("click",()=>{j(Q,ft(D),st)}).datum({fmin:L.fmin,fmax:L.fmax}):h.includes(At)&&Y.append("rect").attr("class","UTR").attr("x",S(L.fmin)).attr("transform",`translate(0,${b-N})`).attr("z-index",20).attr("height",b).attr("width",S(L.fmax)-S(L.fmin)).on("click",()=>{j(Q,ft(D),st)}).datum({fmin:L.fmin,fmax:L.fmax})})),z+=1}if(z===u&&!mt){let X=la(f,d,g,_);++rt,mt=!0,yt.append("a").attr("class","transcriptLabel").attr("xlink:show","new").append("text").attr("x",10).attr("y",10).attr("transform",`translate(0,${z*E+20+I})`).attr("fill","red").attr("opacity",1).attr("height",x).html(X)}}})}}return r&&oa(r,a),z===0&&yt.append("text").attr("x",30).attr("y",x+10).attr("fill","orange").attr("opacity",.6).text("Overview of non-coding genome features unavailable at this time."),z*E+I+et}filterVariantData(e,n){if(n.length===0)return e;try{return e.filter(r=>{var a,s,o;let i=!1;try{(n.indexOf(r.name)>=0||(a=r.allele_symbols)!=null&&a.values&&n.indexOf(r.allele_symbols.values[0].replace(/"/g,""))>=0||(s=r.symbol)!=null&&s.values&&n.indexOf(r.symbol.values[0].replace(/"/g,""))>=0||(o=r.symbol_text)!=null&&o.values&&n.indexOf(r.symbol_text.values[0].replace(/"/g,""))>=0)&&(i=!0),r.allele_ids.values[0].replace(/"|\[|\]| /g,"").split(",").forEach(l=>{n.indexOf(l)>=0&&(i=!0)})}catch(c){console.error("error processing filter with so returning anyway",n,r,c),i=!0}return i})}catch(r){console.warn("problem filtering variant data",e,n,r)}}renderTooltipDescription(e,n,r){e.transition().duration(200).style("width","auto").style("height","auto").style("opacity",1).style("visibility","visible"),e.html(n).style("left",`${window.event.pageX+10}px`).style("top",`${window.event.pageY+10}px`).append("button").attr("type","button").text("Close").on("click",()=>r()),e.append("button").attr("type","button").html("&times;").attr("class","tooltipDivX").on("click",()=>r())}setInitialHighlight(e,n){let r=n.node().getBBox().height;n.selectAll(".variant-deletion,.variant-SNV,.variant-insertion,.variant-delins").filter(a=>{let s=!1;return a.alleles&&(a.alleles[0].replace(/"|\[|\]| /g,"").split(",").forEach(c=>{e.includes(c)&&(s=!0)}),a.alleles.forEach(c=>{e.includes(c)&&(s=!0)})),s}).datum(a=>(a.selected="true",a)).style("stroke","black").each(function(){let a=G(this).attr("x"),s=G(this).attr("width");s==null&&(s=3,a=a-s/2),n.select(".deletions.track").append("rect").attr("class","highlight").attr("x",a).attr("width",s).attr("height",r).attr("fill","yellow").attr("opacity",.8).lower()})}async populateTrack(e){await Promise.all([this.getTrackData(e),this.getVariantData(e)])}async getTrackData(e){this.trackData=await this.service.fetchDataFromUrl(e,"isoform_url")}async getVariantData(e){this.variantData=await this.service.fetchDataFromUrl(e,"variant_url")}}let wn=new fr;class bf{constructor({viewer:e,height:n,width:r,transcriptTypes:i,variantTypes:a,showVariantLabel:s,variantFilter:o,service:c}){this.trackData={},this.variantData={},this.viewer=e,this.width=r,this.variantFilter=o,this.height=n,this.transcriptTypes=i,this.variantTypes=a,this.showVariantLabel=s!==void 0?s:!0,this.service=c||wn}DrawTrack(){let e=this.trackData,n=this.filterVariantData(this.variantData,this.variantFilter),r=this.viewer,i=this.width,a=this.showVariantLabel,s=10,o=["UTR","five_prime_UTR","three_prime_UTR"],c=["CDS"],l=["exon"],f=this.transcriptTypes,d=sa(e,f),u=d.fmin,h=d.fmax;const w=10,T=10,$=40,k=20,g=2,_=0,p=10,v=10,E=20,y=4,A=20,x=10,b=`0,0 0,${A} ${x},${x}`,m=10,N=10,V=H=>`${H-N/2},${m} ${H},0 ${H+N/2},${m}`,C=H=>`${H-N/2},${m} ${H+N/2},${m} ${H-N/2},0 ${H+N/2},0`,W=H=>`${H},${m} ${H+N/2},${m/2} ${H},0 ${H-N/2},${m/2}`;let M=zt().domain([u,h]).range([0,i]),et=ce(this.viewer),ot=r.append("g").attr("transform",`translate(0,${et})`).attr("class","track"),S={};for(let H=0,tt=o.length;H<tt;H++)S[o[H]]=200;for(let H=0,tt=c.length;H<tt;H++)S[c[H]]=1e3;for(let H=0,tt=l.length;H<tt;H++)S[l[H]]=100;let Z={};e=e.sort((H,tt)=>H.selected&&!tt.selected?-1:!H.selected&&tt.selected?1:H.name-tt.name);let K=0,nt=G("body").append("div").attr("class","gfc-tooltip").style("visibility","visible").style("opacity",0);const ht=()=>{nt.transition().duration(100).style("opacity",10).style("visibility","hidden")};let I=0,Q=[],st=-1,gt=-1,dt=this.renderTooltipDescription;for(let H=0;H<e.length&&I<s;H++){let tt=e[H],xt=tt.children;if(xt){let bt=tt.selected;xt=xt.sort((F,yt)=>F.name<yt.name?-1:F.name>yt.name?1:F-yt);let Ut=!1;xt.forEach(F=>{let yt=F.type;if(f.indexOf(yt)>=0){let z=cr(Q,M(F.fmin),M(F.fmax));if(I<s){let pt,ut,_t=!1;Object.keys(Z).includes(tt.name)||(K+=k,_t=!0,Z[tt.name]="Green");let j=ot.append("g").attr("class","isoform").attr("transform",`translate(0,${I*$+10+K})`);_t&&(pt=tt.name,ut=j.append("text").attr("class","geneLabel").attr("fill",bt?"sandybrown":"black").attr("height",_).attr("transform",`translate(${M(F.fmin)},-${k})`).text(pt).on("click",()=>{dt(nt,ft(tt),ht)}).datum({fmin:F.fmin})),j.append("polygon").datum(()=>({fmin:F.fmin,fmax:F.fmax,strand:tt.strand})).attr("class","transArrow").attr("points",b).attr("transform",R=>tt.strand>0?`translate(${Number(M(R.fmax))},0)`:`translate(${Number(M(R.fmin))},${A}) rotate(180)`).on("click",()=>{dt(nt,ft(F),ht)}),j.append("rect").attr("class","transcriptBackbone").attr("y",10+_).attr("height",y).attr("transform",`translate(${M(F.fmin)},0)`).attr("width",M(F.fmax)-M(F.fmin)).on("click",()=>{dt(nt,ft(F),ht)}).datum({fmin:F.fmin,fmax:F.fmax}),pt=F.name,ut=j.append("text").attr("class","transcriptLabel").attr("fill",bt?"sandybrown":"gray").attr("opacity",bt?1:.5).attr("height",_).attr("transform",`translate(${M(F.fmin)},0)`).text(pt).on("click",()=>{dt(nt,ft(F),ht)}).datum({fmin:F.fmin});let Pt=pt.length*2,B;try{Pt=ut.node().getBBox().width}catch{}if(Number(Pt+M(F.fmin))>i,Pt>M(F.fmax)-M(F.fmin)?B=M(F.fmin)+Pt:B=M(F.fmax),Q[z]){let R=Q[z];R.push(`${M(F.fmin)}:${B}`),Q[z]=R}else Q[z]=[`${M(F.fmin)}:${B}`];(st<0||st>F.fmin)&&(st=F.fmin),(gt<0||gt<F.fmax)&&(gt=F.fmax),F.children&&(F.children=F.children.sort((R,J)=>{let P=S[R.type],mt=S[J.type];return typeof P=="number"&&typeof mt=="number"?P-mt:typeof P=="number"&&typeof mt!="number"?-1:typeof P!="number"&&typeof mt=="number"?1:R.type-J.type}),F.children.forEach(R=>{let J=R.type,P=!1;if(l.includes(J)?(P=!0,j.append("rect").attr("class","exon").attr("x",M(R.fmin)).attr("transform",`translate(0,${w-y})`).attr("height",w).attr("z-index",10).attr("width",M(R.fmax)-M(R.fmin)).on("click",()=>{dt(nt,ft(F),ht)}).datum({fmin:R.fmin,fmax:R.fmax})):c.includes(J)?(P=!0,j.append("rect").attr("class","CDS").attr("x",M(R.fmin)).attr("transform",`translate(0,${T-y})`).attr("z-index",20).attr("height",T).attr("width",M(R.fmax)-M(R.fmin)).on("click",()=>{dt(nt,ft(F),ht)}).datum({fmin:R.fmin,fmax:R.fmax})):o.includes(J)&&(P=!0,j.append("rect").attr("class","UTR").attr("x",M(R.fmin)).attr("transform",`translate(0,${p-y})`).attr("z-index",20).attr("height",p).attr("width",M(R.fmax)-M(R.fmin)).on("click",()=>{dt(nt,ft(F),ht)}).datum({fmin:R.fmin,fmax:R.fmax})),P){let mt=ua(n);_f(n),mt.forEach(D=>{let{type:ct,fmax:rt,fmin:X}=D;if(X<R.fmin&&rt>R.fmin||rt>R.fmax&&X<R.fmax||rt<=R.fmax&&X>=R.fmin){let kt=!0;const Et=Pn(D),Y=qn(Et)[0];let q=Un(Et);const it=Math.ceil(M(rt)-M(X))<g?g:Math.ceil(M(rt)-M(X));if(ct.toLowerCase()==="deletion"||ct.toLowerCase()==="mnv"?j.append("rect").attr("class","variant-deletion").attr("x",M(X)).attr("transform",`translate(0,${E-y})`).attr("z-index",30).attr("fill",Y).attr("height",v).attr("width",it).on("click",()=>{dt(nt,q,ht)}).datum({fmin:X,fmax:rt}):ct.toLowerCase()==="snv"||ct.toLowerCase()==="point_mutation"?j.append("polygon").attr("class","variant-SNV").attr("points",W(M(X))).attr("fill",Y).attr("x",M(X)).attr("transform",`translate(0,${E-y})`).attr("z-index",30).on("click",()=>{dt(nt,q,ht)}).datum({fmin:X,fmax:rt}):ct.toLowerCase()==="insertion"?j.append("polygon").attr("class","variant-insertion").attr("points",V(M(X))).attr("fill",Y).attr("x",M(X)).attr("transform",`translate(0,${E-y})`).attr("z-index",30).on("click",()=>{dt(nt,q,ht)}).datum({fmin:X,fmax:rt}):ct.toLowerCase()==="delins"||ct.toLowerCase()==="substitution"||ct.toLowerCase()==="indel"?j.append("polygon").attr("class","variant-delins").attr("points",C(M(X))).attr("x",M(X)).attr("transform",`translate(0,${E-y})`).attr("fill",Y).attr("z-index",30).on("click",()=>{dt(nt,q,ht)}).datum({fmin:X,fmax:rt}):(console.warn("type not found",ct,D),kt=!1),kt&&a){let L=be(D);const At=L.length?L.length:1;j.append("text").attr("class","variantLabel").attr("fill",bt?"sandybrown":Y).attr("opacity",bt?1:.5).attr("height",_).attr("transform",`translate(${M(X-At/2*100)},${E*2.2-y})`).html(L).on("click",()=>{dt(nt,q,ht)}).datum({fmin:F.fmin})}}})}})),I+=1}I===s&&!Ut&&(++z,Ut=!0,ot.append("a").attr("class","transcriptLabel").attr("xlink:show","new").append("text").attr("x",10).attr("y",10).attr("transform",`translate(0,${I*$+20+K})`).attr("fill","red").attr("opacity",1).attr("height",_).text("Maximum features displayed.  See full view for more."))}})}}return I===0&&ot.append("text").attr("x",30).attr("y",_+10).attr("fill","orange").attr("opacity",.6).text("Overview of non-coding genome features unavailable at this time."),I*$+K}filterVariantData(e,n){return n.length===0?e:e.filter(r=>n.indexOf(r.name)>=0)}renderTooltipDescription(e,n,r){e.transition().duration(200).style("width","auto").style("height","auto").style("opacity",1).style("visibility","visible"),e.html(n).style("left",`${window.event.pageX+10}px`).style("top",`${window.event.pageY+10}px`).append("button").attr("type","button").text("Close").on("click",()=>r()),e.append("button").attr("type","button").html("&times;").attr("class","tooltipDivX").on("click",()=>r())}async populateTrack(e){await this.getTrackData(e),await this.getVariantData(e)}async getTrackData(e){this.trackData=await wn.fetchDataFromUrl(e,"isoform_url")}async getVariantData(e){this.variantData=await wn.fetchDataFromUrl(e,"variant_url")}}let kf=new fr;class Af{constructor({viewer:e,track:n,height:r,width:i,transcriptTypes:a,htpVariant:s,service:o}){this.trackData={},this.viewer=e,this.width=i,this.height=r,this.transcriptTypes=a,this.htpVariant=s,this.start=n.start,this.end=n.end,this.genome=n.genome,this.service=o||kf}renderTooltipDescription(e,n,r){e.transition().duration(200).style("width","auto").style("height","auto").style("opacity",1).style("visibility","visible"),e.html(n).style("left",`${window.event.pageX+10}px`).style("top",`${window.event.pageY+10}px`).append("button").attr("type","button").text("Close").on("click",()=>r()),e.append("button").attr("type","button").html("&times;").attr("class","tooltipDivX").on("click",()=>r())}DrawTrack(){let e=this.htpVariant,n=this.trackData,r=this.viewer,i=this.width,a=this.genome,s=this.trackData[0].seqId,o=10,c=["UTR","five_prime_UTR","three_prime_UTR"],l=["CDS"],f=["exon"],d=this.transcriptTypes,u=this.start,h=this.end,w=this.width,T=10,$=10,k=40,g=0,_=10,p=4,v=20,E=10,y=`0,0 0,${v} ${E},${E}`,A=this.renderTooltipDescription,x=zt().domain([u,h]).range([0,i]),b={};for(let Z=0,K=c.length;Z<K;Z++)b[c[Z]]=200;for(let Z=0,K=l.length;Z<K;Z++)b[l[Z]]=1e3;for(let Z=0,K=f.length;Z<K;Z++)b[f[Z]]=100;n=n.sort((Z,K)=>Z.selected&&!K.selected?-1:!Z.selected&&K.selected?1:Z.name-K.name);let m=G("body").append("div").attr("class","gfc-tooltip").style("visibility","visible").style("opacity",0);const N=()=>{m.transition().duration(100).style("opacity",10).style("visibility","hidden")};if(e){let Z=r.append("g").attr("class","variants track").attr("transform","translate(0,22.5)"),[,K]=e.split(":");Z.append("polygon").attr("class","variant-SNV").attr("points",ur(x(K))).attr("fill","red").attr("x",x(K)).attr("z-index",30)}let V=ce(this.viewer),C=r.append("g").attr("transform",`translate(0,${V})`).attr("class","track"),W=0,M=[],et=-1,ot=-1,S=[];for(let Z=0;Z<n.length&&W<o;Z++){let K=n[Z],nt=K.children;if(nt){let ht=K.selected;nt=nt.sort((I,Q)=>I.name<Q.name?-1:I.name>Q.name?1:I-Q),nt.forEach(function(I){let Q=I.type;if(!S.includes(I.id)&&(S.push(I.id),d.indexOf(Q)>=0)){let st=cr(M,x(I.fmin),x(I.fmax));if(W<o){let gt=C.append("g").attr("class","isoform").attr("transform",`translate(0,${W*k+10})`),dt=x(I.fmin)>0?x(I.fmin):0,H=x(I.fmax)>w?w:x(I.fmax);gt.append("polygon").datum(function(){return{strand:K.strand}}).attr("class","transArrow").attr("points",y).attr("transform",()=>K.strand>0?`translate(${H},0)`:`translate(${dt},${v}) rotate(180)`).on("click",()=>{A(m,ft(I),N)}),gt.append("rect").attr("class","transcriptBackbone").attr("y",10+g).attr("height",p).attr("transform",`translate(${dt},0)`).attr("width",H-dt).datum({fmin:I.fmin,fmax:I.fmax}).on("click",()=>{A(m,ft(I),N)});let tt=I.name;K.name!==I.name&&(tt+=` (${K.name})`);let xt=x(I.fmin)>0?x(I.fmin):0,bt=gt.append("text").attr("class","transcriptLabel").attr("fill",ht?"sandybrown":"gray").attr("opacity",ht?1:.5).attr("height",g).attr("transform",`translate(${xt},0)`).text(tt).datum({fmin:I.fmin}).on("click",()=>{A(m,ft(I),N)}),Ut=bt.node().getBBox().width;if(parseFloat(Ut+xt)>w){let z=parseFloat(Ut+xt-w);xt-=z,bt.attr("transform",`translate(${xt},0)`)}let F=tt.length*2,yt;try{F=bt.node().getBBox().width}catch{}if(Number(F+x(I.fmin))>i,F>x(I.fmax)-x(I.fmin)?yt=x(I.fmin)+F:yt=x(I.fmax),M[st]){let z=M[st];z.push(`${x(I.fmin)}:${yt}`),M[st]=z}else M[st]=[`${x(I.fmin)}:${yt}`];(et<0||et>I.fmin)&&(et=I.fmin),(ot<0||ot<I.fmax)&&(ot=I.fmax),I.children&&(I.children=I.children.sort(function(z,pt){let ut=b[z.type],_t=b[pt.type];return typeof ut=="number"&&typeof _t=="number"?ut-_t:typeof ut=="number"&&typeof _t!="number"?-1:typeof ut!="number"&&typeof _t=="number"?1:z.type-pt.type}),I.children.forEach(function(z){let pt=z.type;if(x(z.fmin)>w||x(z.fmax)<0)return;let ut=x(z.fmin)>0?x(z.fmin):0,_t=x(z.fmax)>w?w:x(z.fmax);f.includes(pt)?gt.append("rect").attr("class","exon").attr("x",ut).attr("transform",`translate(0,${T-p})`).attr("height",T).attr("z-index",10).attr("width",_t-ut).datum({fmin:z.fmin,fmax:z.fmax}).on("click",()=>{A(m,ft(I),N)}):l.includes(pt)?gt.append("rect").attr("class","CDS").attr("x",ut).attr("transform",`translate(0,${$-p})`).attr("z-index",20).attr("height",$).attr("width",_t-ut).datum({fmin:z.fmin,fmax:z.fmax}).on("click",()=>{A(m,ft(I),N)}):c.includes(pt)&&gt.append("rect").attr("class","UTR").attr("x",ut).attr("transform",`translate(0,${_-p})`).attr("z-index",20).attr("height",_).attr("width",_t-ut).datum({fmin:z.fmin,fmax:z.fmax}).on("click",()=>{A(m,ft(I),N)})})),W+=1}if(W===o){let gt=la(a,s,u,h);++st,C.append("a").attr("class","transcriptLabel").attr("xlink:show","new").append("text").attr("x",10).attr("transform",`translate(0,${W*k+10})`).attr("fill","red").attr("opacity",1).attr("height",g).html(gt)}}})}}return W===0&&C.append("text").attr("x",30).attr("y",g+10).attr("fill","orange").attr("opacity",.6).text("Overview of non-coding genome features unavailable at this time."),W*k}async getTrackData(e){this.trackData=await this.service.fetchDataFromUrl(e,"url")}}class $f{constructor({viewer:e,track:n,height:r,width:i}){this.refSeq="",this.viewer=e,this.width=i,this.height=r,this.track=n}DrawScrollableTrack(){let e=this.viewer,n=this.refSeq,r=zt().domain([this.track.start,this.track.end+1]).range(this.track.range),i=ss(r).tickValues(this._getRefTick(this.track.start+1,this.track.end)).tickFormat((c,l)=>n[l]).tickSize(8).tickSizeInner(8).tickPadding(6),a=Math.floor(n.length/10),s=yr(r).ticks(a).tickValues(this._getRefTick(this.track.start+1,this.track.end,10));e.append("g").attr("class","axis x-local-axis track").attr("width",this.track.range[1]).attr("transform","translate(0, 20)").call(i),e.append("g").attr("class","axis x-local-numerical track").attr("width",this.track.range[1]).attr("transform","translate(0, 20)").call(s);let o=Rt(".x-local-numerical .tick text");o.first().attr("text-anchor","start"),o.last().attr("text-anchor","end"),Rt(".x-local-axis .tick text").each(function(){var c=G(this),l=c.text(),f="nucleotide nt-a";l=="T"?f="nucleotide nt-t":l=="C"?f="nucleotide nt-c":l=="G"&&(f="nucleotide nt-g"),G(this.parentNode).append("rect").attr("class",f).attr("transform","translate(-8,8)")})}DrawOverviewTrack(){let e=this.viewer,n=this.track.start,r=this.track.end,i=this.width,a=zt().domain([n,r]).range(this.track.range),s=yr(a).ticks(8,"s").tickSize(8);e.append("g").attr("class","axis track").attr("width",i).attr("height",20).attr("transform","translate(0,20)").call(s)}_getRefTick(e,n,r){let i=[];return r?i=Array(Math.ceil((n-e+1)/10)).fill().map((a,s)=>e+s*10):i=Array(n-e+1).fill().map((a,s)=>e+s),i}async getTrackData(){}}const O={ISOFORM_EMBEDDED_VARIANT:"ISOFORM_EMBEDDED_VARIANT",ISOFORM_AND_VARIANT:"ISOFORM_AND_VARIANT",ISOFORM:"ISOFORM",VARIANT:"VARIANT",VARIANT_GLOBAL:"VARIANT_GLOBAL"};var Tt="$";function en(){}en.prototype=dr.prototype={constructor:en,has:function(t){return Tt+t in this},get:function(t){return this[Tt+t]},set:function(t,e){return this[Tt+t]=e,this},remove:function(t){var e=Tt+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Tt&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Tt&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Tt&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Tt&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Tt&&++t;return t},empty:function(){for(var t in this)if(t[0]===Tt)return!1;return!0},each:function(t){for(var e in this)e[0]===Tt&&t(this[e],e.slice(1),this)}};function dr(t,e){var n=new en;if(t instanceof en)t.each(function(o,c){n.set(c,o)});else if(Array.isArray(t)){var r=-1,i=t.length,a;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(a=t[r],r,t),a)}else if(t)for(var s in t)n.set(s,t[s]);return n}function qr(){}var qt=dr.prototype;qr.prototype={constructor:qr,has:qt.has,add:function(t){return t+="",this[Tt+t]=t,this},remove:qt.remove,clear:qt.clear,values:qt.keys,size:qt.size,empty:qt.empty,each:qt.each};var Gn="http://www.w3.org/1999/xhtml";const Gr={svg:"http://www.w3.org/2000/svg",xhtml:Gn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function da(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Gr.hasOwnProperty(e)?{space:Gr[e],local:t}:t}function Ef(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Gn&&e.documentElement.namespaceURI===Gn?e.createElement(t):e.createElementNS(n,t)}}function Tf(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function pa(t){var e=da(t);return(e.local?Tf:Ef)(e)}function Rf(){}function ma(t){return t==null?Rf:function(){return this.querySelector(t)}}function Sf(t){typeof t!="function"&&(t=ma(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=new Array(s),c,l,f=0;f<s;++f)(c=a[f])&&(l=t.call(c,c.__data__,f,a))&&("__data__"in c&&(l.__data__=c.__data__),o[f]=l);return new $t(r,this._parents)}function Nf(){return[]}function Mf(t){return t==null?Nf:function(){return this.querySelectorAll(t)}}function Df(t){typeof t!="function"&&(t=Mf(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s=e[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&(r.push(t.call(c,c.__data__,l,s)),i.push(c));return new $t(r,i)}function If(t){return function(){return this.matches(t)}}function Of(t){typeof t!="function"&&(t=If(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new $t(r,this._parents)}function ga(t){return new Array(t.length)}function Ff(){return new $t(this._enter||this._groups.map(ga),this._parents)}function nn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}nn.prototype={constructor:nn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Lf(t){return function(){return t}}var Wr="$";function Vf(t,e,n,r,i,a){for(var s=0,o,c=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new nn(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function Bf(t,e,n,r,i,a,s){var o,c,l={},f=e.length,d=a.length,u=new Array(f),h;for(o=0;o<f;++o)(c=e[o])&&(u[o]=h=Wr+s.call(c,c.__data__,o,e),h in l?i[o]=c:l[h]=c);for(o=0;o<d;++o)h=Wr+s.call(t,a[o],o,a),(c=l[h])?(r[o]=c,c.__data__=a[o],l[h]=null):n[o]=new nn(t,a[o]);for(o=0;o<f;++o)(c=e[o])&&l[u[o]]===c&&(i[o]=c)}function Hf(t,e){if(!t)return h=new Array(this.size()),l=-1,this.each(function(E){h[++l]=E}),h;var n=e?Bf:Vf,r=this._parents,i=this._groups;typeof t!="function"&&(t=Lf(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),l=0;l<a;++l){var f=r[l],d=i[l],u=d.length,h=t.call(f,f&&f.__data__,l,r),w=h.length,T=o[l]=new Array(w),$=s[l]=new Array(w),k=c[l]=new Array(u);n(f,d,T,$,k,h,e);for(var g=0,_=0,p,v;g<w;++g)if(p=T[g]){for(g>=_&&(_=g+1);!(v=$[_])&&++_<w;);p._next=v||null}}return s=new $t(s,r),s._enter=o,s._exit=c,s}function Cf(){return new $t(this._exit||this._groups.map(ga),this._parents)}function zf(t,e,n){var r=this.enter(),i=this,a=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Uf(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var c=e[o],l=n[o],f=c.length,d=s[o]=new Array(f),u,h=0;h<f;++h)(u=c[h]||l[h])&&(d[h]=u);for(;o<r;++o)s[o]=e[o];return new $t(s,this._parents)}function Pf(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function qf(t){t||(t=Gf);function e(d,u){return d&&u?t(d.__data__,u.__data__):!d-!u}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s=n[a],o=s.length,c=i[a]=new Array(o),l,f=0;f<o;++f)(l=s[f])&&(c[f]=l);c.sort(e)}return new $t(i,this._parents).order()}function Gf(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Wf(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Xf(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function Zf(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function Yf(){var t=0;return this.each(function(){++t}),t}function Kf(){return!this.node()}function Jf(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function Qf(t){return function(){this.removeAttribute(t)}}function jf(t){return function(){this.removeAttributeNS(t.space,t.local)}}function tu(t,e){return function(){this.setAttribute(t,e)}}function eu(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function nu(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ru(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function iu(t,e){var n=da(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?jf:Qf:typeof e=="function"?n.local?ru:nu:n.local?eu:tu)(n,e))}function _a(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function au(t){return function(){this.style.removeProperty(t)}}function su(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ou(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function lu(t,e,n){return arguments.length>1?this.each((e==null?au:typeof e=="function"?ou:su)(t,e,n??"")):cu(this.node(),t)}function cu(t,e){return t.style.getPropertyValue(e)||_a(t).getComputedStyle(t,null).getPropertyValue(e)}function fu(t){return function(){delete this[t]}}function uu(t,e){return function(){this[t]=e}}function hu(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function du(t,e){return arguments.length>1?this.each((e==null?fu:typeof e=="function"?hu:uu)(t,e)):this.node()[t]}function wa(t){return t.trim().split(/^|\s+/)}function pr(t){return t.classList||new ya(t)}function ya(t){this._node=t,this._names=wa(t.getAttribute("class")||"")}ya.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function va(t,e){for(var n=pr(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function xa(t,e){for(var n=pr(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function pu(t){return function(){va(this,t)}}function mu(t){return function(){xa(this,t)}}function gu(t,e){return function(){(e.apply(this,arguments)?va:xa)(this,t)}}function _u(t,e){var n=wa(t+"");if(arguments.length<2){for(var r=pr(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?gu:e?pu:mu)(n,e))}function wu(){this.textContent=""}function yu(t){return function(){this.textContent=t}}function vu(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function xu(t){return arguments.length?this.each(t==null?wu:(typeof t=="function"?vu:yu)(t)):this.node().textContent}function bu(){this.innerHTML=""}function ku(t){return function(){this.innerHTML=t}}function Au(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function $u(t){return arguments.length?this.each(t==null?bu:(typeof t=="function"?Au:ku)(t)):this.node().innerHTML}function Eu(){this.nextSibling&&this.parentNode.appendChild(this)}function Tu(){return this.each(Eu)}function Ru(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Su(){return this.each(Ru)}function Nu(t){var e=typeof t=="function"?t:pa(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Mu(){return null}function Du(t,e){var n=typeof t=="function"?t:pa(t),r=e==null?Mu:typeof e=="function"?e:ma(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Iu(){var t=this.parentNode;t&&t.removeChild(this)}function Ou(){return this.each(Iu)}function Fu(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Lu(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Vu(t){return this.select(t?Lu:Fu)}function Bu(t){return arguments.length?this.property("__data__",t):this.node().__data__}var ba={};if(typeof document<"u"){var Hu=document.documentElement;"onmouseenter"in Hu||(ba={mouseenter:"mouseover",mouseleave:"mouseout"})}function Cu(t,e,n){return t=ka(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function ka(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function zu(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Uu(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.capture):e[++r]=a;++r?e.length=r:delete this.__on}}}function Pu(t,e,n){var r=ba.hasOwnProperty(t.type)?Cu:ka;return function(i,a,s){var o=this.__on,c,l=r(e,a,s);if(o){for(var f=0,d=o.length;f<d;++f)if((c=o[f]).type===t.type&&c.name===t.name){this.removeEventListener(c.type,c.listener,c.capture),this.addEventListener(c.type,c.listener=l,c.capture=n),c.value=e;return}}this.addEventListener(t.type,l,n),c={type:t.type,name:t.name,value:e,listener:l,capture:n},o?o.push(c):this.__on=[c]}}function qu(t,e,n){var r=zu(t+""),i,a=r.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,f;c<l;++c)for(i=0,f=o[c];i<a;++i)if((s=r[i]).type===f.type&&s.name===f.name)return f.value}return}for(o=e?Pu:Uu,n==null&&(n=!1),i=0;i<a;++i)this.each(o(r[i],e,n));return this}function Aa(t,e,n){var r=_a(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Gu(t,e){return function(){return Aa(this,t,e)}}function Wu(t,e){return function(){return Aa(this,t,e.apply(this,arguments))}}function Xu(t,e){return this.each((typeof e=="function"?Wu:Gu)(t,e))}var $a=[null];function $t(t,e){this._groups=t,this._parents=e}function Wn(){return new $t([[document.documentElement]],$a)}$t.prototype=Wn.prototype={constructor:$t,select:Sf,selectAll:Df,filter:Of,data:Hf,enter:Ff,exit:Cf,join:zf,merge:Uf,order:Pf,sort:qf,call:Wf,nodes:Xf,node:Zf,size:Yf,empty:Kf,each:Jf,attr:iu,style:lu,property:du,classed:_u,text:xu,html:$u,raise:Tu,lower:Su,append:Nu,insert:Du,remove:Ou,clone:Vu,datum:Bu,on:qu,dispatch:Xu};function Xr(t){return typeof t=="string"?new $t([[document.querySelector(t)]],[document.documentElement]):new $t([[t]],$a)}function Zu(){var t=l,e=f,n=d,r=document.body,i=E(),a=null,s=null,o=null;function c(m){a=y(m),a&&(s=a.createSVGPoint(),r.appendChild(i))}c.show=function(){var m=Array.prototype.slice.call(arguments);m[m.length-1]instanceof SVGElement&&(o=m.pop());var N=n.apply(this,m),V=e.apply(this,m),C=t.apply(this,m),W=A(),M=h.length,et,ot=document.documentElement.scrollTop||r.scrollTop,S=document.documentElement.scrollLeft||r.scrollLeft;for(W.html(N).style("opacity",1).style("pointer-events","all");M--;)W.classed(h[M],!1);return et=u.get(C).apply(this),W.classed(C,!0).style("top",et.top+V[0]+ot+"px").style("left",et.left+V[1]+S+"px"),c},c.hide=function(){var m=A();return m.style("opacity",0).style("pointer-events","none"),c},c.attr=function(m,N){if(arguments.length<2&&typeof m=="string")return A().attr(m);var V=Array.prototype.slice.call(arguments);return Wn.prototype.attr.apply(A(),V),c},c.style=function(m,N){if(arguments.length<2&&typeof m=="string")return A().style(m);var V=Array.prototype.slice.call(arguments);return Wn.prototype.style.apply(A(),V),c},c.direction=function(m){return arguments.length?(t=m==null?m:b(m),c):t},c.offset=function(m){return arguments.length?(e=m==null?m:b(m),c):e},c.html=function(m){return arguments.length?(n=m==null?m:b(m),c):n},c.rootElement=function(m){return arguments.length?(r=m==null?m:b(m),c):r},c.destroy=function(){return i&&(A().remove(),i=null),c};function l(){return"n"}function f(){return[0,0]}function d(){return" "}var u=dr({n:w,s:T,e:$,w:k,nw:g,ne:_,sw:p,se:v}),h=u.keys();function w(){var m=x(this);return{top:m.n.y-i.offsetHeight,left:m.n.x-i.offsetWidth/2}}function T(){var m=x(this);return{top:m.s.y,left:m.s.x-i.offsetWidth/2}}function $(){var m=x(this);return{top:m.e.y-i.offsetHeight/2,left:m.e.x}}function k(){var m=x(this);return{top:m.w.y-i.offsetHeight/2,left:m.w.x-i.offsetWidth}}function g(){var m=x(this);return{top:m.nw.y-i.offsetHeight,left:m.nw.x-i.offsetWidth}}function _(){var m=x(this);return{top:m.ne.y-i.offsetHeight,left:m.ne.x}}function p(){var m=x(this);return{top:m.sw.y,left:m.sw.x-i.offsetWidth}}function v(){var m=x(this);return{top:m.se.y,left:m.se.x}}function E(){var m=Xr(document.createElement("div"));return m.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),m.node()}function y(m){var N=m.node();return N?N.tagName.toLowerCase()==="svg"?N:N.ownerSVGElement:null}function A(){return i==null&&(i=E(),r.appendChild(i)),Xr(i)}function x(m){for(var N=o||m;N.getScreenCTM==null&&N.parentNode!=null;)N=N.parentNode;var V={},C=N.getScreenCTM(),W=N.getBBox(),M=W.width,et=W.height,ot=W.x,S=W.y;return s.x=ot,s.y=S,V.nw=s.matrixTransform(C),s.x+=M,V.ne=s.matrixTransform(C),s.y+=et,V.se=s.matrixTransform(C),s.x-=M,V.sw=s.matrixTransform(C),s.y-=et/2,V.w=s.matrixTransform(C),s.x+=M,V.e=s.matrixTransform(C),s.x-=M/2,s.y-=et/2,V.n=s.matrixTransform(C),s.y+=et,V.s=s.matrixTransform(C),V}function b(m){return typeof m=="function"?m:function(){return m}}return c}class Yu{constructor({viewer:e,track:n,height:r,width:i}){this.variants=[],this.viewer=e,this.width=i,this.height=r,this.track=n}DrawTrack(){let e=this.viewer,n=this.variants,r=zt().domain([this.track.start,this.track.end+1]).range(this.track.range),i=aa().type(ia).size(20),a=Zu();a.attr("class","d3-tip").html(d=>`<table><th colspan="2">${"Case Variant".toUpperCase()}</th><tr><td>Position</td> <td>${d.position}</td></tr><tr><td>Mutation</td> <td>${d.ref} > ${d.mutant}</td></tr></table>`).offset([10,0]).direction("s"),e.call(a);let s=20,o=ce(this.viewer),c=e.append("g").attr("transform",`translate(0,${o})`).attr("class","track");c.append("rect").attr("height",s).attr("width",-this.track.range[0]+this.track.range[1]).attr("fill-opacity",.1).attr("fill","rgb(148, 140, 140)").attr("stroke-width",0).attr("stroke-opacity",0).attr("transform",`translate(${this.track.range[0]},0)`),c.selectAll("path").data(n).enter().append("path").attr("d",i).attr("class","case-variant").attr("stroke","red").attr("fill","red").attr("transform",d=>`translate(${r(d.position)},10)`).on("mouseenter",a.show).on("mouseout",a.hide);let f=G("#viewer2").append("g").attr("transform",`translate(25,${o})`).attr("class","track-label");f.append("line").attr("x1",75).attr("y1",0).attr("x2",75).attr("y2",s).attr("stroke-width",3).attr("stroke","#609C9C"),f.append("text").text(this.track.label.toUpperCase()).attr("y",12)}async getTrackData(){}}class Ku{constructor({viewer:e,track:n,height:r,width:i}){this.variants=[],this.viewer=e,this.width=i,this.height=r,this.track=n}DrawTrack(){let e=this.viewer,n=this.variants,r=zt().domain([this.track.start,this.track.end]).range(this.track.range),i=aa().type(ia).size(20),a=20,s=ce(this.viewer),o=e.append("g").attr("transform",`translate(0,${s})`).attr("class","track");o.append("rect").attr("height",a).attr("width",-this.track.range[0]+this.track.range[1]).attr("fill-opacity",.1).attr("fill","rgb(148, 140, 140)").attr("stroke-width",0).attr("stroke-opacity",0),o.selectAll("path").data(n).enter().append("path").attr("d",i).attr("class","global-variant").attr("stroke","red").attr("fill","red").attr("transform",c=>`translate(${r(c.position)},10)`)}async getTrackData(){}}const yn=100;class Ju{constructor(e){this.gfc=e,this.used=0,this.drag_cx=0,this.drag_prev=0,this.range=[]}draw(){let e=this.gfc.width,n=this.gfc.config.transcriptTypes?this.gfc.config.transcriptTypes:["mRNA"],r=this.gfc.config.variantTypes?this.gfc.config.variantTypes:["point_mutation","MNV","Deletion","Insertion","Delins"],i=this.gfc.config.binRatio?this.gfc.config.binRatio:.01,a=null,s=null;this.gfc.locale==="local"&&(e=document.body.clientWidth,a=()=>{this.dragged(this)},s=()=>{this.drag_start(this)},G(this.gfc.svg_target).append("defs").append("svg:clipPath").attr("id","clip").append("rect").attr("id","clip-rect").attr("x","0").attr("y","0").attr("height",this.gfc.height).attr("width",this.gfc.width-yn).attr("transform",`translate(${yn},0)`),this.gfc.viewer.attr("clip-path","url(#clip)"));let o=this.gfc.config,c=this._configureRange(o.start,o.end,e);this.range=c.range;let l=o.chromosome,f=o.variantFilter?o.variantFilter:[],d=o.isoformFilter?o.isoformFilter:[],u=o.initialHighlight?o.initialHighlight:[],h=o.htpVariant?o.htpVariant:"",w=c.start,T=c.end;const $=new $f({viewer:this.gfc.viewer,track:{chromosome:l,start:w,end:T,range:c.range},height:this.gfc.height,width:e,service:this.gfc.service});this.gfc.locale==="local"?($.DrawScrollableTrack(),this.gfc.viewer.call(Ko().on("start",s).on("drag",a))):$.DrawOverviewTrack();let k=yn;this.gfc.tracks.forEach(async g=>{if(g.start=w,g.end=T,g.chromosome=l,g.variant_filter=f,g.isoform_filter=d,g.initialHighlight=u,g.type===O.ISOFORM_AND_VARIANT){const _=new xf({viewer:this.gfc.viewer,track:g,height:this.gfc.height,width:e,transcriptTypes:n,variantTypes:r,showVariantLabel:this.gfc.config.showVariantLabel,variantFilter:f,binRatio:i,isoformFilter:d,initialHighlight:u,service:this.gfc.service});await _.populateTrack(g,()=>g.isoformFunction,()=>g.variantFunction),k+=_.DrawTrack()}else if(g.type===O.ISOFORM_EMBEDDED_VARIANT){const _=new bf({viewer:this.gfc.viewer,track:g,height:this.gfc.height,width:e,transcriptTypes:n,variantTypes:r,showVariantLabel:this.gfc.config.showVariantLabel,variantFilter:f,binRatio:i,service:this.gfc.service});await _.populateTrack(g,()=>g.isoformFunction,()=>g.variantFunction),k+=_.DrawTrack()}else if(g.type===O.ISOFORM){const _=new Af({viewer:this.gfc.viewer,track:g,height:this.gfc.height,width:e,transcriptTypes:n,htpVariant:h,service:this.gfc.service});await _.getTrackData(g),k+=_.DrawTrack()}else if(g.type===O.VARIANT){g.range=c.range;const _=new Yu({viewer:this.gfc.viewer,track:g,height:this.gfc.height,width:e,service:this.gfc.service});await _.getTrackData(),_.DrawTrack()}else if(g.type===O.VARIANT_GLOBAL){g.range=c.range;const _=new Ku({viewer:this.gfc.viewer,track:g,height:this.gfc.height,width:e,service:this.gfc.service});await _.getTrackData(),_.DrawTrack()}else console.error(`TrackType not found for ${g.id}...`,g.type);G(this.gfc.svg_target).attr("height",k)})}drag_start(e){e.drag_cx=window.event.x}dragged(e){let n=`${e.gfc.svg_target} .x-local-axis .tick`,r=parseInt(G(n).node().getBoundingClientRect().width)*2;if(e.drag_cx!=window.event.x){let i=0;e.drag_cx<window.event.x?i=1:i=-1,e.scrollView(i,r),e.drag_cx=window.event.x}}scrollView(e,n){let r={maxNegative:this.gfc.width-this.range[1]+-(n/2)},i=`${this.gfc.svg_target} .main-view .track`;Rt(i).attr("transform",()=>{let a=uf(G(this).attr("transform")),s=0;return e==1?s=a[0]+n:e==-1&&(s=a[0]-n),s<=r.maxNegative||s>-this.range[0]+100+n/2?`translate(${a[0]},${a[1]})`:`translate(${s},${a[1]})`})}_configureRange(e,n,r){let i=null,a=17,s=0,o=[0,0];if(e===n){i=300,s=a*i,e=e-i/2-1,n=n+i/2;let c=G("#clip-rect").node().getBoundingClientRect().width/2+100;o=[c-s/2,c+s/2]}else return{range:[0,r],start:e,end:n};return{range:o,start:e,end:n}}}function Xn(t,e){return`<svg width="15" top="3" viewBox="0 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><rect fill="${t}" stroke="none" height="10" width="10"></svg>${e}</polygons></svg>`}function lt(t){return t=="unknown"?Xn("grey",t.replace(/_/g," ")):Xn(Pe[t].color,t.replace(/_/g," "))}function Qu(){let t="<table><tbody>";return t+="<tr>",t+='<td align="center" valign="top"><u><b>Variant types</b></u></td>',t+='<td align="center" valign="top" colspan="2"><u><b>Molecular Consequences</b></u></td>',t+="</tr>",t+="<tr>",t+='<td valign="top" ><ul style="list-style-type:none;">',t+=`<li><svg width="15" top="3" viewBox="-7 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><polygon stroke="black" fill="black" points="${ur(0)}"></svg>point mutation</polygons></svg></li>`,t+=`<li>${Xn("black","deletion")}</li>`,t+=`<li><svg width="15" top="3" viewBox="-7 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><polygon stroke="black" fill="black" points="${ca(0)}"></svg>insertion</polygons></svg></li>`,t+=`<li><svg width="15" top="3" viewBox="-7 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><polygon stroke="black" fill="black" points="${fa(0)}"></svg>delins/MNV </polygons></svg></li>`,t+="</ul></td>",t+='<td valign="top" ><ul style="list-style-type:none;">',t+=`<li>${lt("transcript_ablation")}</li>`,t+=`<li>${lt("splice_acceptor_variant")}</li>`,t+=`<li>${lt("splice_donor_variant")}</li>`,t+=`<li>${lt("stop_gained")}</li>`,t+=`<li>${lt("frameshift_variant")}</li>`,t+=`<li>${lt("stop_lost")}</li>`,t+=`<li>${lt("start_lost")}</li>`,t+=`<li>${lt("inframe_insertion")}</li>`,t+=`<li>${lt("inframe_deletion")}</li>`,t+=`<li>${lt("missense_variant")}</li>`,t+="</ul></td>",t+='<td valign="top" ><ul style="list-style-type:none;">',t+=`<li>${lt("protein_altering_variant")}</li>`,t+=`<li>${lt("splice_region_variant")}</li>`,t+=`<li>${lt("start_retained_variant")}</li>`,t+=`<li>${lt("stop_retained_variant")}</li>`,t+=`<li>${lt("synonymous_variant")}</li>`,t+=`<li>${lt("coding_sequence_variant")}</li>`,t+=`<li>${lt("five_prime_UTR_variant")}</li>`,t+=`<li>${lt("three_prime_UTR_variant")}</li>`,t+=`<li>${lt("intron_variant")}</li>`,t+=`<li>${lt("non_coding_transcript_variant")}</li>`,t+=`<li>${lt("unknown")}</li>`,t+="</ul></td>",t+="</tr>",t+="<tr>",t+="<td></td>",t+='<td colspan="2"><a href="https://uswest.ensembl.org/info/genome/variation/prediction/predicted_data.html">Source: Ensembl</a></td>',t+="</tr>",t+="</tbody></table>",t}class Yt{constructor(e,n,r,i){this.tracks=[],this.locale="",this.config={},this.svg_target=n,this._checkConfig(e),this._extendD3(),this.height=i,this.width=r,this.viewer=this._initViewer(n),this.drawer=new Ju(this),this.service=e.service,this.drawer.draw()}generateLegend(){return Qu()}closeModal(){const e=document.getElementsByClassName("gfc-tooltip");for(let n of e)n.style.visibility="hidden"}setSelectedAlleles(e,n){let r=G(n);r.selectAll(".highlight").remove(),r.selectAll(".variant-deletion,.variant-SNV,.variant-insertion,.variant-delins").filter(i=>i.selected).style("stroke",null).datum(i=>(i.selected="false",i)),oa(e,r)}_checkConfig(e){let n=e.locale;if(n!=="global"&&n!=="local")throw new Error("No locale found in config. Must be 'global' or 'local'");let r=e.tracks;if(!r||r.length===0)throw new Error("No tracks found. Must be an array of tracks.");this._setProperties(e)}_extendD3(){Kt.prototype.first=function(){return G(this.nodes()[0])},Kt.prototype.last=function(){return G(this.nodes()[this.size()-1])}}_setProperties(e){this.config=e,this.tracks=e.tracks,this.locale=e.locale}_initViewer(e){G(e).selectAll("*").remove();let n=G(e),i=`${e.replace("#","")} main-view`;if(this.locale==="global"){let s={top:8,right:30,bottom:30,left:40};n.attr("width",this.width).attr("height",this.height).append("g").attr("transform",`translate(${s.left},${s.top})`).attr("class",i),this.width=this.width-s.left-s.right,this.height=this.height-s.top-s.bottom}else{let s={top:10,bottom:10};n.attr("width",this.width).attr("height",this.height).append("g").attr("class",i),this.height=this.height-s.top-s.bottom}let a=`${e} .main-view`;return G(a)}getTracks(e){return e?this.tracks[0]:this.tracks}setSequence(e,n){this.config.start=e,this.config.end=n}}function Ea(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vn,Zr;function ju(){if(Zr)return vn;Zr=1;class t{constructor(n={}){if(!(n.maxSize&&n.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=n.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(n,r){this.cache.set(n,r),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(n){if(this.cache.has(n))return this.cache.get(n);if(this.oldCache.has(n)){const r=this.oldCache.get(n);return this.oldCache.delete(n),this._set(n,r),r}}set(n,r){return this.cache.has(n)?this.cache.set(n,r):this._set(n,r),this}has(n){return this.cache.has(n)||this.oldCache.has(n)}peek(n){if(this.cache.has(n))return this.cache.get(n);if(this.oldCache.has(n))return this.oldCache.get(n)}delete(n){const r=this.cache.delete(n);return r&&this._size--,this.oldCache.delete(n)||r}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[n]of this)yield n}*values(){for(const[,n]of this)yield n}*[Symbol.iterator](){for(const n of this.cache)yield n;for(const n of this.oldCache){const[r]=n;this.cache.has(r)||(yield n)}}get size(){let n=0;for(const r of this.oldCache.keys())this.cache.has(r)||n++;return this._size+n}}return vn=t,vn}var th=ju();const mr=Ea(th);class eh{}class nh{constructor(){this.signals=new Set,this.abortController=new AbortController}addSignal(e=new eh){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(e),e.aborted?this.handleAborted(e):typeof e.addEventListener=="function"&&e.addEventListener("abort",()=>{this.handleAborted(e)})}handleAborted(e){this.signals.delete(e),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}class rh{constructor(){this.callbacks=new Set}addCallback(e=()=>{}){this.callbacks.add(e),e(this.currentMessage)}callback(e){this.currentMessage=e;for(const n of this.callbacks)n(e)}}class fe{constructor({fill:e,cache:n}){if(typeof e!="function")throw new TypeError("must pass a fill function");if(typeof n!="object")throw new TypeError("must pass a cache object");if(typeof n.get!="function"||typeof n.set!="function"||typeof n.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=n,this.fillCallback=e}static isAbortException(e){return e.name==="AbortError"||e.code==="ERR_ABORTED"||e.message==="AbortError: aborted"||e.message==="Error: aborted"}evict(e,n){this.cache.get(e)===n&&this.cache.delete(e)}fill(e,n,r,i){const a=new nh,s=new rh;s.addCallback(i);const o={aborter:a,promise:this.fillCallback(n,a.signal,c=>{s.callback(c)}),settled:!1,statusReporter:s,get aborted(){return this.aborter.signal.aborted}};o.aborter.addSignal(r),o.aborter.signal.addEventListener("abort",()=>{o.settled||this.evict(e,o)}),o.promise.then(()=>{o.settled=!0},()=>{o.settled=!0,this.evict(e,o)}).catch(c=>{throw console.error(c),c}),this.cache.set(e,o)}static checkSinglePromise(e,n){function r(){if(n!=null&&n.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return e.then(i=>(r(),i),i=>{throw r(),i})}has(e){return this.cache.has(e)}get(e,n,r,i){if(!r&&n instanceof AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const a=this.cache.get(e);return a?a.aborted&&!a.settled?(this.evict(e,a),this.get(e,n,r,i)):a.settled?a.promise:(a.aborter.addSignal(r),a.statusReporter.addCallback(i),fe.checkSinglePromise(a.promise,r)):(this.fill(e,n,r,i),fe.checkSinglePromise(this.cache.get(e).promise,r))}delete(e){const n=this.cache.get(e);n&&(n.settled||n.aborter.abort(),this.cache.delete(e))}clear(){const e=this.cache.keys();let n=0;for(let r=e.next();!r.done;r=e.next())this.delete(r.value),n+=1;return n}}var qe={exports:{}},ih=qe.exports,Yr;function ah(){return Yr||(Yr=1,function(t,e){(function(n,r){t.exports=r()})(ih,function(){const n=/^[\w+.-]+:\/\//,r=/^([\w+.-]+:)\/\/([^@/#?]*@)?([^:/#?]*)(:\d+)?(\/[^#?]*)?(\?[^#]*)?(#.*)?/,i=/^file:(?:\/\/((?![a-z]:)[^/#?]*)?)?(\/?[^#?]*)(\?[^#]*)?(#.*)?/i;function a(g){return n.test(g)}function s(g){return g.startsWith("//")}function o(g){return g.startsWith("/")}function c(g){return g.startsWith("file:")}function l(g){return/^[.?#]/.test(g)}function f(g){const _=r.exec(g);return u(_[1],_[2]||"",_[3],_[4]||"",_[5]||"/",_[6]||"",_[7]||"")}function d(g){const _=i.exec(g),p=_[2];return u("file:","",_[1]||"","",o(p)?p:"/"+p,_[3]||"",_[4]||"")}function u(g,_,p,v,E,y,A){return{scheme:g,user:_,host:p,port:v,path:E,query:y,hash:A,type:7}}function h(g){if(s(g)){const p=f("http:"+g);return p.scheme="",p.type=6,p}if(o(g)){const p=f("http://foo.com"+g);return p.scheme="",p.host="",p.type=5,p}if(c(g))return d(g);if(a(g))return f(g);const _=f("http://foo.com/"+g);return _.scheme="",_.host="",_.type=g?g.startsWith("?")?3:g.startsWith("#")?2:4:1,_}function w(g){if(g.endsWith("/.."))return g;const _=g.lastIndexOf("/");return g.slice(0,_+1)}function T(g,_){$(_,_.type),g.path==="/"?g.path=_.path:g.path=w(_.path)+g.path}function $(g,_){const p=_<=4,v=g.path.split("/");let E=1,y=0,A=!1;for(let b=1;b<v.length;b++){const m=v[b];if(!m){A=!0;continue}if(A=!1,m!=="."){if(m===".."){y?(A=!0,y--,E--):p&&(v[E++]=m);continue}v[E++]=m,y++}}let x="";for(let b=1;b<E;b++)x+="/"+v[b];(!x||A&&!x.endsWith("/.."))&&(x+="/"),g.path=x}function k(g,_){if(!g&&!_)return"";const p=h(g);let v=p.type;if(_&&v!==7){const y=h(_),A=y.type;switch(v){case 1:p.hash=y.hash;case 2:p.query=y.query;case 3:case 4:T(p,y);case 5:p.user=y.user,p.host=y.host,p.port=y.port;case 6:p.scheme=y.scheme}A>v&&(v=A)}$(p,v);const E=p.query+p.hash;switch(v){case 2:case 3:return E;case 4:{const y=p.path.slice(1);return y?l(_||g)&&!l(y)?"./"+y+E:y+E:E||"."}case 5:return p.path+E;default:return p.scheme+"//"+p.user+p.host+p.port+p.path+E}}return k})}(qe)),qe.exports}var sh=ah();const oh=Ea(sh);async function gr(t,e,n={}){const{defaultContent:r={}}=n;try{const i=await e(t,{encoding:"utf8"}),a=new TextDecoder("utf8");return JSON.parse(a.decode(i))}catch(i){if(i.code==="ENOENT"||i.status===404||i.message.includes("404")||i.message.includes("ENOENT"))return r;throw i}}function _r(t,e="."){return oh(t,e)}class lh{constructor({readFile:e,cacheSize:n=100}){if(this.topList=[],this.chunkCache=new fe({cache:new mr({maxSize:n}),fill:this.readChunkItems.bind(this)}),this.readFile=e,!this.readFile)throw new Error('must provide a "readFile" function')}importExisting(e,n,r,i,a){this.topList=e,this.attrs=n,this.start=n.makeFastGetter("Start"),this.end=n.makeFastGetter("End"),this.lazyClass=a,this.baseURL=r,this.lazyUrlTemplate=i}binarySearch(e,n,r){let i=-1,a=e.length,s;for(;a-i>1;)s=i+a>>>1,r(e[s])>=n?a=s:i=s;return r===this.end?a:i}readChunkItems(e){const n=_r(this.lazyUrlTemplate.replaceAll(/\{Chunk\}/gi,e),this.baseURL);return gr(n,this.readFile,{defaultContent:[]})}async*iterateSublist(e,n,r,i,a,s,o){const c=this.attrs.makeGetter("Chunk"),l=this.attrs.makeGetter("Sublist"),f=[];for(let d=this.binarySearch(e,n,a);d<e.length&&d>=0&&i*s(e[d])<i*r;d+=i){if(e[d][0]===this.lazyClass){const h=c(e[d]),w=this.chunkCache.get(h,h).then(T=>[T,h]);f.push(w)}else yield[e[d],o.concat(d)];const u=l(e[d]);u&&(yield*this.iterateSublist(u,n,r,i,a,s,o.concat(d)))}for(const d of f){const[u,h]=await d;u&&(yield*this.iterateSublist(u,n,r,i,a,s,[...o,h]))}}async*iterate(e,n){const r=e>n?-1:1,i=e>n?this.start:this.end,a=e>n?this.end:this.start;this.topList.length>0&&(yield*this.iterateSublist(this.topList,e,n,r,i,a,[0]))}async histogram(e,n,r){const i=new Array(r);i.fill(0);const a=(n-e)/r;for await(const s of this.iterate(e,n)){const o=Math.max(0,(this.start(s)-e)/a|0),c=Math.min(r,(this.end(s)-e)/a|0);for(let l=o;l<=c;l+=1)i[l]+=1}return i}}class ch{constructor(e){this.classes=e,this.fields=[];for(let n=0;n<e.length;n+=1){this.fields[n]={};for(let r=0;r<e[n].attributes.length;r+=1)this.fields[n][e[n].attributes[r]]=r+1;e[n].proto===void 0&&(e[n].proto={}),e[n].isArrayAttr===void 0&&(e[n].isArrayAttr={})}}attrIndices(e){return this.classes.map(n=>n.attributes.indexOf(e)+1||n.attributes.indexOf(e.toLowerCase())+1||void 0)}get(e,n){if(n in this.fields[e[0]])return e[this.fields[e[0]][n]];const r=n.toLowerCase();if(r in this.fields[e[0]])return e[this.fields[e[0]][r]];const i=this.classes[e[0]].attributes.length+1;return i>=e.length||!(n in e[i])?n in this.classes[e[0]].proto?this.classes[e[0]].proto[n]:void 0:e[i][n]}makeSetter(e){return(n,r)=>{this.set(n,e,r)}}makeGetter(e){return n=>this.get(n,e)}makeFastGetter(e){const n=this.attrIndices(e);return function(i){if(n[i[0]]!==void 0)return i[n[i[0]]]}}accessors(){return this._accessors||(this._accessors=this._makeAccessors()),this._accessors}_makeAccessors(){const e={},n={get(i){const a=this.get.field_accessors[i.toLowerCase()];if(a)return a.call(this)},set(i,a){const s=this.set.field_accessors[i];if(s)return s.call(this,a)},tags(){return r[this[0]]||[]}};n.get.field_accessors={},n.set.field_accessors={},this.classes.forEach((i,a)=>{(i.attributes||[]).forEach((s,o)=>{e[s]=e[s]||[],e[s][a]=o+1,s=s.toLowerCase(),e[s]=e[s]||[],e[s][a]=o+1})});const r=this.classes.map(i=>i.attributes);return Object.keys(e).forEach(i=>{const a=e[i];n.get.field_accessors[i]=a?function(){return this[a[this[0]]]}:function(){}}),n}}class fh{constructor({urlTemplate:e,chunkSize:n,length:r,cacheSize:i=100,readFile:a},s){if(this.urlTemplate=e,this.chunkSize=n,this.length=r,this.baseUrl=s===void 0?"":s,this.readFile=a,!a)throw new Error("must provide readFile callback");this.chunkCache=new fe({cache:new mr({maxSize:i}),fill:this.getChunk.bind(this)})}index(e,n,r){this.range(e,e,n,void 0,r)}async*range(e,n){e=Math.max(0,e),n=Math.min(n,this.length-1);const r=Math.floor(e/this.chunkSize),i=Math.floor(n/this.chunkSize),a=[];for(let s=r;s<=i;s+=1)a.push(this.chunkCache.get(s,s));for(const s of a){const[o,c]=await s;yield*this.filterChunkData(e,n,o,c)}}async getChunk(e){let n=this.urlTemplate.replaceAll(/\{Chunk\}/gi,e);this.baseUrl&&(n=_r(n,this.baseUrl));const r=await gr(n,this.readFile);return[e,r]}*filterChunkData(e,n,r,i){const a=r*this.chunkSize,s=Math.max(0,e-a),o=Math.min(n-a,this.chunkSize-1);for(let c=s;c<=o;c+=1)yield[c+a,i[c]]}}function uh(){return this._uniqueID}function hh(){return this._parent}function dh(){return this.get("subfeatures")}class ph{constructor({baseUrl:e,urlTemplate:n,readFile:r,cacheSize:i=10}){if(this.baseUrl=e,this.urlTemplates={root:n},this.readFile=r,!this.readFile)throw new Error('must provide a "readFile" function argument');this.dataRootCache=new fe({cache:new mr({maxSize:i}),fill:this.fetchDataRoot.bind(this)})}makeNCList(){return new lh({readFile:this.readFile})}loadNCList(e,n,r){e.nclist.importExisting(n.intervals.nclist,e.attrs,r,n.intervals.urlTemplate,n.intervals.lazyClass)}getDataRoot(e){return this.dataRootCache.get(e,e)}fetchDataRoot(e){const n=_r(this.urlTemplates.root.replaceAll(/{\s*refseq\s*}/g,e),this.baseUrl);return gr(n,this.readFile).then(r=>this.parseTrackInfo(r,n))}parseTrackInfo(e,n){const r={nclist:this.makeNCList(),stats:{featureCount:e.featureCount||0}};e.intervals&&(r.attrs=new ch(e.intervals.classes),this.loadNCList(r,e,n));const{histograms:i}=e;if(i!=null&&i.meta){for(let a=0;a<i.meta.length;a+=1)i.meta[a].lazyArray=new fh({...i.meta[a].arrayParams,readFile:this.readFile},n);r._histograms=i}return r._histograms&&Object.keys(r._histograms).forEach(a=>{r._histograms[a].forEach(o=>{Object.keys(o).forEach(c=>{typeof o[c]=="string"&&String(Number(o[c]))===o[c]&&(o[c]=Number(o[c]))})})}),r}async getRegionStats(e){return(await this.getDataRoot(e.ref)).stats}async getRegionFeatureDensities({refName:e,start:n,end:r,numBins:i,basesPerBin:a}){const s=await this.getDataRoot(e);if(i)a=(r-n)/i;else if(a)i=Math.ceil((r-n)/a);else throw new TypeError("numBins or basesPerBin arg required for getRegionFeatureDensities");const c=(s._histograms.stats||[]).find(u=>u.basesPerBin>=a);let l=s._histograms.meta[0];for(let u=0;u<s._histograms.meta.length;u+=1)a>=s._histograms.meta[u].basesPerBin&&(l=s._histograms.meta[u]);let f=a/l.basesPerBin;if(f>.9&&Math.abs(f-Math.round(f))<1e-4){const u=Math.floor(n/l.basesPerBin);f=Math.round(f);const h=[];for(let w=0;w<i;w+=1)h[w]=0;for await(const[w,T]of l.lazyArray.range(u,u+f*i-1))h[Math.floor((w-u)/f)]+=T;return{bins:h,stats:c}}return{bins:await s.nclist.histogram(n,r,i),stats:c}}async*getFeatures({refName:e,start:n,end:r}){var s;const i=await this.getDataRoot(e),a=(s=i.attrs)==null?void 0:s.accessors();for await(const[o,c]of i.nclist.iterate(n,r)){if(!o.decorated){const l=c.join(",");this.decorateFeature(a,o,`${e},${l}`)}yield o}}decorateFeature(e,n,r,i){n.get=e.get,n.tags=e.tags,n._uniqueID=r,n.id=uh,n._parent=i,n.parent=hh,n.children=dh,(n.get("subfeatures")||[]).forEach((a,s)=>{this.decorateFeature(e,a,`${r}-${s}`,n)}),n.decorated=!0}}function he(t){let e=t.length;for(;--e>=0;)t[e]=0}const mh=3,gh=258,Ta=29,_h=256,wh=_h+1+Ta,Ra=30,yh=512,vh=new Array((wh+2)*2);he(vh);const xh=new Array(Ra*2);he(xh);const bh=new Array(yh);he(bh);const kh=new Array(gh-mh+1);he(kh);const Ah=new Array(Ta);he(Ah);const $h=new Array(Ra);he($h);const Eh=(t,e,n,r)=>{let i=t&65535|0,a=t>>>16&65535|0,s=0;for(;n!==0;){s=n>2e3?2e3:n,n-=s;do i=i+e[r++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var Zn=Eh;const Th=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},Rh=new Uint32Array(Th()),Sh=(t,e,n,r)=>{const i=Rh,a=r+n;t^=-1;for(let s=r;s<a;s++)t=t>>>8^i[(t^e[s])&255];return t^-1};var It=Sh,Yn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Sa={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Nh=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Mh=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)Nh(n,r)&&(t[r]=n[r])}}return t},Dh=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,a=t.length;r<a;r++){let s=t[r];n.set(s,i),i+=s.length}return n},Na={assign:Mh,flattenChunks:Dh};let Ma=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ma=!1}const ke=new Uint8Array(256);for(let t=0;t<256;t++)ke[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ke[254]=ke[254]=1;var Ih=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,a,s=t.length,o=0;for(i=0;i<s;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<s&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),a=0,i=0;a<o;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<s&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|n&63):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|n&63):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|n&63);return e};const Oh=(t,e)=>{if(e<65534&&t.subarray&&Ma)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var Fh=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const a=new Array(n*2);for(i=0,r=0;r<n;){let s=t[r++];if(s<128){a[i++]=s;continue}let o=ke[s];if(o>4){a[i++]=65533,r+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&r<n;)s=s<<6|t[r++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return Oh(a,i)},Lh=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+ke[t[n]]>e?n:e},Kn={string2buf:Ih,buf2string:Fh,utf8border:Lh};function Vh(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Bh=Vh;const Oe=16209,Hh=16191;var Ch=function(e,n){let r,i,a,s,o,c,l,f,d,u,h,w,T,$,k,g,_,p,v,E,y,A,x,b;const m=e.state;r=e.next_in,x=e.input,i=r+(e.avail_in-5),a=e.next_out,b=e.output,s=a-(n-e.avail_out),o=a+(e.avail_out-257),c=m.dmax,l=m.wsize,f=m.whave,d=m.wnext,u=m.window,h=m.hold,w=m.bits,T=m.lencode,$=m.distcode,k=(1<<m.lenbits)-1,g=(1<<m.distbits)-1;t:do{w<15&&(h+=x[r++]<<w,w+=8,h+=x[r++]<<w,w+=8),_=T[h&k];e:for(;;){if(p=_>>>24,h>>>=p,w-=p,p=_>>>16&255,p===0)b[a++]=_&65535;else if(p&16){v=_&65535,p&=15,p&&(w<p&&(h+=x[r++]<<w,w+=8),v+=h&(1<<p)-1,h>>>=p,w-=p),w<15&&(h+=x[r++]<<w,w+=8,h+=x[r++]<<w,w+=8),_=$[h&g];n:for(;;){if(p=_>>>24,h>>>=p,w-=p,p=_>>>16&255,p&16){if(E=_&65535,p&=15,w<p&&(h+=x[r++]<<w,w+=8,w<p&&(h+=x[r++]<<w,w+=8)),E+=h&(1<<p)-1,E>c){e.msg="invalid distance too far back",m.mode=Oe;break t}if(h>>>=p,w-=p,p=a-s,E>p){if(p=E-p,p>f&&m.sane){e.msg="invalid distance too far back",m.mode=Oe;break t}if(y=0,A=u,d===0){if(y+=l-p,p<v){v-=p;do b[a++]=u[y++];while(--p);y=a-E,A=b}}else if(d<p){if(y+=l+d-p,p-=d,p<v){v-=p;do b[a++]=u[y++];while(--p);if(y=0,d<v){p=d,v-=p;do b[a++]=u[y++];while(--p);y=a-E,A=b}}}else if(y+=d-p,p<v){v-=p;do b[a++]=u[y++];while(--p);y=a-E,A=b}for(;v>2;)b[a++]=A[y++],b[a++]=A[y++],b[a++]=A[y++],v-=3;v&&(b[a++]=A[y++],v>1&&(b[a++]=A[y++]))}else{y=a-E;do b[a++]=b[y++],b[a++]=b[y++],b[a++]=b[y++],v-=3;while(v>2);v&&(b[a++]=b[y++],v>1&&(b[a++]=b[y++]))}}else if(p&64){e.msg="invalid distance code",m.mode=Oe;break t}else{_=$[(_&65535)+(h&(1<<p)-1)];continue n}break}}else if(p&64)if(p&32){m.mode=Hh;break t}else{e.msg="invalid literal/length code",m.mode=Oe;break t}else{_=T[(_&65535)+(h&(1<<p)-1)];continue e}break}}while(r<i&&a<o);v=w>>3,r-=v,w-=v<<3,h&=(1<<w)-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=a<o?257+(o-a):257-(a-o),m.hold=h,m.bits=w};const ne=15,Kr=852,Jr=592,Qr=0,xn=1,jr=2,zh=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Uh=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ph=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),qh=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Gh=(t,e,n,r,i,a,s,o)=>{const c=o.bits;let l=0,f=0,d=0,u=0,h=0,w=0,T=0,$=0,k=0,g=0,_,p,v,E,y,A=null,x;const b=new Uint16Array(ne+1),m=new Uint16Array(ne+1);let N=null,V,C,W;for(l=0;l<=ne;l++)b[l]=0;for(f=0;f<r;f++)b[e[n+f]]++;for(h=c,u=ne;u>=1&&b[u]===0;u--);if(h>u&&(h=u),u===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<u&&b[d]===0;d++);for(h<d&&(h=d),$=1,l=1;l<=ne;l++)if($<<=1,$-=b[l],$<0)return-1;if($>0&&(t===Qr||u!==1))return-1;for(m[1]=0,l=1;l<ne;l++)m[l+1]=m[l]+b[l];for(f=0;f<r;f++)e[n+f]!==0&&(s[m[e[n+f]]++]=f);if(t===Qr?(A=N=s,x=20):t===xn?(A=zh,N=Uh,x=257):(A=Ph,N=qh,x=0),g=0,f=0,l=d,y=a,w=h,T=0,v=-1,k=1<<h,E=k-1,t===xn&&k>Kr||t===jr&&k>Jr)return 1;for(;;){V=l-T,s[f]+1<x?(C=0,W=s[f]):s[f]>=x?(C=N[s[f]-x],W=A[s[f]-x]):(C=96,W=0),_=1<<l-T,p=1<<w,d=p;do p-=_,i[y+(g>>T)+p]=V<<24|C<<16|W|0;while(p!==0);for(_=1<<l-1;g&_;)_>>=1;if(_!==0?(g&=_-1,g+=_):g=0,f++,--b[l]===0){if(l===u)break;l=e[n+s[f]]}if(l>h&&(g&E)!==v){for(T===0&&(T=h),y+=d,w=l-T,$=1<<w;w+T<u&&($-=b[w+T],!($<=0));)w++,$<<=1;if(k+=1<<w,t===xn&&k>Kr||t===jr&&k>Jr)return 1;v=g&E,i[v]=h<<24|w<<16|y-a|0}}return g!==0&&(i[y+g]=l-T<<24|64<<16|0),o.bits=h,0};var _e=Gh;const Wh=0,Da=1,Ia=2,{Z_FINISH:ti,Z_BLOCK:Xh,Z_TREES:Fe,Z_OK:jt,Z_STREAM_END:Zh,Z_NEED_DICT:Yh,Z_STREAM_ERROR:St,Z_DATA_ERROR:Oa,Z_MEM_ERROR:Fa,Z_BUF_ERROR:Kh,Z_DEFLATED:ei}=Sa,fn=16180,ni=16181,ri=16182,ii=16183,ai=16184,si=16185,oi=16186,li=16187,ci=16188,fi=16189,rn=16190,Vt=16191,bn=16192,ui=16193,kn=16194,hi=16195,di=16196,pi=16197,mi=16198,Le=16199,Ve=16200,gi=16201,_i=16202,wi=16203,yi=16204,vi=16205,An=16206,xi=16207,bi=16208,at=16209,La=16210,Va=16211,Jh=852,Qh=592,jh=15,t0=jh,ki=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function e0(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const te=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<fn||e.mode>Va?1:0},Ba=t=>{if(te(t))return St;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=fn,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Jh),e.distcode=e.distdyn=new Int32Array(Qh),e.sane=1,e.back=-1,jt},Ha=t=>{if(te(t))return St;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ba(t)},Ca=(t,e)=>{let n;if(te(t))return St;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?St:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,Ha(t))},za=(t,e)=>{if(!t)return St;const n=new e0;t.state=n,n.strm=t,n.window=null,n.mode=fn;const r=Ca(t,e);return r!==jt&&(t.state=null),r},n0=t=>za(t,t0);let Ai=!0,$n,En;const r0=t=>{if(Ai){$n=new Int32Array(512),En=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(_e(Da,t.lens,0,288,$n,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;_e(Ia,t.lens,0,32,En,0,t.work,{bits:5}),Ai=!1}t.lencode=$n,t.lenbits=9,t.distcode=En,t.distbits=5},Ua=(t,e,n,r)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(e.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(e.subarray(n-r,n-r+i),a.wnext),r-=i,r?(a.window.set(e.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},i0=(t,e)=>{let n,r,i,a,s,o,c,l,f,d,u,h,w,T,$=0,k,g,_,p,v,E,y,A;const x=new Uint8Array(4);let b,m;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(te(t)||!t.output||!t.input&&t.avail_in!==0)return St;n=t.state,n.mode===Vt&&(n.mode=bn),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,r=t.input,o=t.avail_in,l=n.hold,f=n.bits,d=o,u=c,A=jt;t:for(;;)switch(n.mode){case fn:if(n.wrap===0){n.mode=bn;break}for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.wrap&2&&l===35615){n.wbits===0&&(n.wbits=15),n.check=0,x[0]=l&255,x[1]=l>>>8&255,n.check=It(n.check,x,2,0),l=0,f=0,n.mode=ni;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",n.mode=at;break}if((l&15)!==ei){t.msg="unknown compression method",n.mode=at;break}if(l>>>=4,f-=4,y=(l&15)+8,n.wbits===0&&(n.wbits=y),y>15||y>n.wbits){t.msg="invalid window size",n.mode=at;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=l&512?fi:Vt,l=0,f=0;break;case ni:for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.flags=l,(n.flags&255)!==ei){t.msg="unknown compression method",n.mode=at;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=at;break}n.head&&(n.head.text=l>>8&1),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,n.check=It(n.check,x,2,0)),l=0,f=0,n.mode=ri;case ri:for(;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.head&&(n.head.time=l),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,x[2]=l>>>16&255,x[3]=l>>>24&255,n.check=It(n.check,x,4,0)),l=0,f=0,n.mode=ii;case ii:for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.head&&(n.head.xflags=l&255,n.head.os=l>>8),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,n.check=It(n.check,x,2,0)),l=0,f=0,n.mode=ai;case ai:if(n.flags&1024){for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.length=l,n.head&&(n.head.extra_len=l),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,n.check=It(n.check,x,2,0)),l=0,f=0}else n.head&&(n.head.extra=null);n.mode=si;case si:if(n.flags&1024&&(h=n.length,h>o&&(h=o),h&&(n.head&&(y=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+h),y)),n.flags&512&&n.wrap&4&&(n.check=It(n.check,r,h,a)),o-=h,a+=h,n.length-=h),n.length))break t;n.length=0,n.mode=oi;case oi:if(n.flags&2048){if(o===0)break t;h=0;do y=r[a+h++],n.head&&y&&n.length<65536&&(n.head.name+=String.fromCharCode(y));while(y&&h<o);if(n.flags&512&&n.wrap&4&&(n.check=It(n.check,r,h,a)),o-=h,a+=h,y)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=li;case li:if(n.flags&4096){if(o===0)break t;h=0;do y=r[a+h++],n.head&&y&&n.length<65536&&(n.head.comment+=String.fromCharCode(y));while(y&&h<o);if(n.flags&512&&n.wrap&4&&(n.check=It(n.check,r,h,a)),o-=h,a+=h,y)break t}else n.head&&(n.head.comment=null);n.mode=ci;case ci:if(n.flags&512){for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.wrap&4&&l!==(n.check&65535)){t.msg="header crc mismatch",n.mode=at;break}l=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Vt;break;case fi:for(;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}t.adler=n.check=ki(l),l=0,f=0,n.mode=rn;case rn:if(n.havedict===0)return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,n.hold=l,n.bits=f,Yh;t.adler=n.check=1,n.mode=Vt;case Vt:if(e===Xh||e===Fe)break t;case bn:if(n.last){l>>>=f&7,f-=f&7,n.mode=An;break}for(;f<3;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}switch(n.last=l&1,l>>>=1,f-=1,l&3){case 0:n.mode=ui;break;case 1:if(r0(n),n.mode=Le,e===Fe){l>>>=2,f-=2;break t}break;case 2:n.mode=di;break;case 3:t.msg="invalid block type",n.mode=at}l>>>=2,f-=2;break;case ui:for(l>>>=f&7,f-=f&7;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if((l&65535)!==(l>>>16^65535)){t.msg="invalid stored block lengths",n.mode=at;break}if(n.length=l&65535,l=0,f=0,n.mode=kn,e===Fe)break t;case kn:n.mode=hi;case hi:if(h=n.length,h){if(h>o&&(h=o),h>c&&(h=c),h===0)break t;i.set(r.subarray(a,a+h),s),o-=h,a+=h,c-=h,s+=h,n.length-=h;break}n.mode=Vt;break;case di:for(;f<14;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.nlen=(l&31)+257,l>>>=5,f-=5,n.ndist=(l&31)+1,l>>>=5,f-=5,n.ncode=(l&15)+4,l>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=at;break}n.have=0,n.mode=pi;case pi:for(;n.have<n.ncode;){for(;f<3;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.lens[N[n.have++]]=l&7,l>>>=3,f-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,b={bits:n.lenbits},A=_e(Wh,n.lens,0,19,n.lencode,0,n.work,b),n.lenbits=b.bits,A){t.msg="invalid code lengths set",n.mode=at;break}n.have=0,n.mode=mi;case mi:for(;n.have<n.nlen+n.ndist;){for(;$=n.lencode[l&(1<<n.lenbits)-1],k=$>>>24,g=$>>>16&255,_=$&65535,!(k<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(_<16)l>>>=k,f-=k,n.lens[n.have++]=_;else{if(_===16){for(m=k+2;f<m;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(l>>>=k,f-=k,n.have===0){t.msg="invalid bit length repeat",n.mode=at;break}y=n.lens[n.have-1],h=3+(l&3),l>>>=2,f-=2}else if(_===17){for(m=k+3;f<m;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=k,f-=k,y=0,h=3+(l&7),l>>>=3,f-=3}else{for(m=k+7;f<m;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=k,f-=k,y=0,h=11+(l&127),l>>>=7,f-=7}if(n.have+h>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=at;break}for(;h--;)n.lens[n.have++]=y}}if(n.mode===at)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=at;break}if(n.lenbits=9,b={bits:n.lenbits},A=_e(Da,n.lens,0,n.nlen,n.lencode,0,n.work,b),n.lenbits=b.bits,A){t.msg="invalid literal/lengths set",n.mode=at;break}if(n.distbits=6,n.distcode=n.distdyn,b={bits:n.distbits},A=_e(Ia,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,b),n.distbits=b.bits,A){t.msg="invalid distances set",n.mode=at;break}if(n.mode=Le,e===Fe)break t;case Le:n.mode=Ve;case Ve:if(o>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,n.hold=l,n.bits=f,Ch(t,u),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,r=t.input,o=t.avail_in,l=n.hold,f=n.bits,n.mode===Vt&&(n.back=-1);break}for(n.back=0;$=n.lencode[l&(1<<n.lenbits)-1],k=$>>>24,g=$>>>16&255,_=$&65535,!(k<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(g&&!(g&240)){for(p=k,v=g,E=_;$=n.lencode[E+((l&(1<<p+v)-1)>>p)],k=$>>>24,g=$>>>16&255,_=$&65535,!(p+k<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=p,f-=p,n.back+=p}if(l>>>=k,f-=k,n.back+=k,n.length=_,g===0){n.mode=vi;break}if(g&32){n.back=-1,n.mode=Vt;break}if(g&64){t.msg="invalid literal/length code",n.mode=at;break}n.extra=g&15,n.mode=gi;case gi:if(n.extra){for(m=n.extra;f<m;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=_i;case _i:for(;$=n.distcode[l&(1<<n.distbits)-1],k=$>>>24,g=$>>>16&255,_=$&65535,!(k<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(!(g&240)){for(p=k,v=g,E=_;$=n.distcode[E+((l&(1<<p+v)-1)>>p)],k=$>>>24,g=$>>>16&255,_=$&65535,!(p+k<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=p,f-=p,n.back+=p}if(l>>>=k,f-=k,n.back+=k,g&64){t.msg="invalid distance code",n.mode=at;break}n.offset=_,n.extra=g&15,n.mode=wi;case wi:if(n.extra){for(m=n.extra;f<m;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=at;break}n.mode=yi;case yi:if(c===0)break t;if(h=u-c,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=at;break}h>n.wnext?(h-=n.wnext,w=n.wsize-h):w=n.wnext-h,h>n.length&&(h=n.length),T=n.window}else T=i,w=s-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do i[s++]=T[w++];while(--h);n.length===0&&(n.mode=Ve);break;case vi:if(c===0)break t;i[s++]=n.length,c--,n.mode=Ve;break;case An:if(n.wrap){for(;f<32;){if(o===0)break t;o--,l|=r[a++]<<f,f+=8}if(u-=c,t.total_out+=u,n.total+=u,n.wrap&4&&u&&(t.adler=n.check=n.flags?It(n.check,i,u,s-u):Zn(n.check,i,u,s-u)),u=c,n.wrap&4&&(n.flags?l:ki(l))!==n.check){t.msg="incorrect data check",n.mode=at;break}l=0,f=0}n.mode=xi;case xi:if(n.wrap&&n.flags){for(;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.wrap&4&&l!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=at;break}l=0,f=0}n.mode=bi;case bi:A=Zh;break t;case at:A=Oa;break t;case La:return Fa;case Va:default:return St}return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,n.hold=l,n.bits=f,(n.wsize||u!==t.avail_out&&n.mode<at&&(n.mode<An||e!==ti))&&Ua(t,t.output,t.next_out,u-t.avail_out),d-=t.avail_in,u-=t.avail_out,t.total_in+=d,t.total_out+=u,n.total+=u,n.wrap&4&&u&&(t.adler=n.check=n.flags?It(n.check,i,u,t.next_out-u):Zn(n.check,i,u,t.next_out-u)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Vt?128:0)+(n.mode===Le||n.mode===kn?256:0),(d===0&&u===0||e===ti)&&A===jt&&(A=Kh),A},a0=t=>{if(te(t))return St;let e=t.state;return e.window&&(e.window=null),t.state=null,jt},s0=(t,e)=>{if(te(t))return St;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,jt):St},o0=(t,e)=>{const n=e.length;let r,i,a;return te(t)||(r=t.state,r.wrap!==0&&r.mode!==rn)?St:r.mode===rn&&(i=1,i=Zn(i,e,n,0),i!==r.check)?Oa:(a=Ua(t,e,n,n),a?(r.mode=La,Fa):(r.havedict=1,jt))};var l0=Ha,c0=Ca,f0=Ba,u0=n0,h0=za,d0=i0,p0=a0,m0=s0,g0=o0,_0="pako inflate (from Nodeca project)",Bt={inflateReset:l0,inflateReset2:c0,inflateResetKeep:f0,inflateInit:u0,inflateInit2:h0,inflate:d0,inflateEnd:p0,inflateGetHeader:m0,inflateSetDictionary:g0,inflateInfo:_0};function w0(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var y0=w0;const Pa=Object.prototype.toString,{Z_NO_FLUSH:v0,Z_FINISH:x0,Z_OK:Ae,Z_STREAM_END:Tn,Z_NEED_DICT:Rn,Z_STREAM_ERROR:b0,Z_DATA_ERROR:$i,Z_MEM_ERROR:k0}=Sa;function un(t){this.options=Na.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bh,this.strm.avail_out=0;let n=Bt.inflateInit2(this.strm,e.windowBits);if(n!==Ae)throw new Error(Yn[n]);if(this.header=new y0,Bt.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Kn.string2buf(e.dictionary):Pa.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Bt.inflateSetDictionary(this.strm,e.dictionary),n!==Ae)))throw new Error(Yn[n])}un.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?x0:v0,Pa.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=Bt.inflate(n,s),a===Rn&&i&&(a=Bt.inflateSetDictionary(n,i),a===Ae?a=Bt.inflate(n,s):a===$i&&(a=Rn));n.avail_in>0&&a===Tn&&n.state.wrap>0&&t[n.next_in]!==0;)Bt.inflateReset(n),a=Bt.inflate(n,s);switch(a){case b0:case $i:case Rn:case k0:return this.onEnd(a),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||a===Tn))if(this.options.to==="string"){let c=Kn.utf8border(n.output,n.next_out),l=n.next_out-c,f=Kn.buf2string(n.output,c);n.next_out=l,n.avail_out=r-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===Ae&&o===0)){if(a===Tn)return a=Bt.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};un.prototype.onData=function(t){this.chunks.push(t)};un.prototype.onEnd=function(t){t===Ae&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Na.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function A0(t,e){const n=new un(e);if(n.push(t),n.err)throw n.msg||Yn[n.err];return n.result}var $0=A0,E0={inflate:$0};const{inflate:T0}=E0;var R0=T0;const S0={refName:"seq_id"},N0={seq_id:"refName"};class an{constructor(e,n,r){this.ncFeature=e,this.uniqueId=r||e.id(),this.parentHandle=n}set(){throw new Error("not implemented")}jb2TagToJb1Tag(e){return(S0[e]||e).toLowerCase()}jb1TagToJb2Tag(e){const n=e.toLowerCase();return N0[n]||n}get(e){const n=this.ncFeature.get(this.jb2TagToJb1Tag(e));return n&&e==="subfeatures"?n.map(r=>new an(r,this)):n}tags(){return this.ncFeature.tags().map(e=>this.jb1TagToJb2Tag(e))}id(){return this.uniqueId}parent(){return this.parentHandle}children(){return this.get("subfeatures")}toJSON(){const e={uniqueId:this.id(),subfeatures:[]};return this.ncFeature.tags().forEach(n=>{const r=this.jb1TagToJb2Tag(n),i=this.ncFeature.get(n);r==="subfeatures"?e.children=(i||[]).map(a=>new an(a,this).toJSON()):e[r]=i}),{...e,fmin:e.start,fmax:e.end,seqId:e.refName}}}function M0(t){return t[0]===31&&t[1]===139&&t[2]===8}async function D0(t){const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status} fetching ${t}`);const n=await e.arrayBuffer();return M0(n)?R0(n):n}class I0{async fetchDataFromUrl(e){const{urlTemplate:n,baseUrl:r}=e.url,i=new ph({urlTemplate:n,baseUrl:r,readFile:D0,compressed:!0});let a=[];for await(const s of i.getFeatures({refName:e.chromosome,start:+e.start,end:+e.end}))a.push(new an(s).toJSON());return a}}const ue="https://www.alliancegenome.org/apollo";G0();U0();z0();C0();B0();H0();V0();O0();F0();L0();function hn(){return["mRNA","ncRNA","piRNA","lincRNA","miRNA","pre_miRNA","snoRNA","lnc_RNA","tRNA","snRNA","rRNA","ARS","antisense_RNA","C_gene_segment","V_gene_segment","pseudogene_attribute","snoRNA_gene","polypeptide_region","mature_protein_region"]}function O0(){q0("NC_045512.2:17894..28259","SARS-CoV-2","covidExample1",O.ISOFORM,!1)}function F0(){P0("NC_045512.2:17894..28259","SARS-CoV-2","nclistviewer",O.ISOFORM,!1)}function L0(){U("5:120503475..120682281","rat","viewerActnFly",O.ISOFORM_AND_VARIANT,!1,[],[],[]),sn("17:43044295..43170245","human","viewerHumanVariant",O.ISOFORM,!1),U("9:42732992..42873700","zebrafish","viewerHighlightExample",O.ISOFORM_AND_VARIANT,!1),U("chrIV:1276654..1277169","yeast","viewerSGDexample",O.ISOFORM_AND_VARIANT,!1)}function V0(){U("2L:130639..135911","fly","viewerFlyExample1",O.ISOFORM_EMBEDDED_VARIANT,!0),U("2R:23974973..23989002","fly","viewerFlyExample3",O.ISOFORM_EMBEDDED_VARIANT,!0,["NT_033778.4:g.23975146T>C"]),U("2R:23974973..23989002","fly","viewerFlyExample2",O.ISOFORM_EMBEDDED_VARIANT,!0),U("2L:130639..135911","fly","viewerFlyExample1NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),U("2R:23974973..23989002","fly","viewerFlyExample3NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1,["NT_033778.4:g.23975146T>C"]),U("2R:23974973..23989002","fly","viewerFlyExample2NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),U("2R:23974973..23989002","fly","viewerFlyExample2NoLabelAnd",O.ISOFORM_AND_VARIANT,!1),U("3R:22693140..22699809","fly","viewerFlyExample3",O.ISOFORM_AND_VARIANT,!1),U("2R:23974972..23989001","fly","viewerFlyExample4",O.ISOFORM_AND_VARIANT,!1),U("3R:22693140..22699809","fly","viewerFlyExample5",O.ISOFORM_AND_VARIANT,!1,["FB:FBal0265700","FB:FBal0265699"]),U("2R:18614210..18615018","fly","viewerFlyExample6",O.ISOFORM_AND_VARIANT,!1,["FB:FBal0325512"]),U("X:2023822..2043557","fly","viewerFlyExample7",O.ISOFORM_AND_VARIANT,!1,["FB:FBal0212726"])}function B0(){U("10:94485648..94489071","rat","networkExampleRat1",O.ISOFORM_EMBEDDED_VARIANT,!0,null),U("10:94485648..94489071","rat","networkExampleRat1And",O.ISOFORM_AND_VARIANT,!0,null),U("1:34987290..35280466","rat","viewerRatExample1",O.ISOFORM_EMBEDDED_VARIANT,!0),U("1:34987290..35280466","rat","viewerRatExample1NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1)}function H0(){U("18:11035719..11058885","mouse","viewerMouseExample6",O.ISOFORM_AND_VARIANT,!1),sn("18:11042037..11052567","mouse","viewerMouseExample5",O.ISOFORM,!1),U("17:46007760..46041588","mouse","viewerMouseExample4",O.ISOFORM_AND_VARIANT,!1),U("11:69550420..69563869","mouse","viewerMouseExample3",O.ISOFORM_AND_VARIANT,!1),U("3:115707662..115717830","mouse","viewerMouseExample2",O.ISOFORM_AND_VARIANT,!1),U("6:113619452..113636198","mouse","viewerMouseExample1",O.ISOFORM_EMBEDDED_VARIANT,!0),U("6:113619452..113636198","mouse","viewerMouseExample1NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),U("6:113619452..113636198","mouse","viewerMouseExample1NoLabelAnd",O.ISOFORM_AND_VARIANT,!1)}function C0(){U("14:5383966..5390885","zebrafish","viewerFishLbx2",O.ISOFORM_EMBEDDED_VARIANT,!0),U("8:40452405..40469627","zebrafish","viewerFishMyl7",O.ISOFORM_EMBEDDED_VARIANT,!0),U("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),U("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabelAnd",O.ISOFORM_AND_VARIANT,!1),U("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabelAndNameOnly",O.ISOFORM_AND_VARIANT,!1,["NC_007125.7:g.5388210A>T"]),U("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabelAndSymbolOnly",O.ISOFORM_AND_VARIANT,!1,["hu3336"]),U("8:40452405..40469627","zebrafish","viewerFishMyl7NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1)}function z0(){U("V:7106..57424","worm","viewerWormEgl8",O.ISOFORM_EMBEDDED_VARIANT,!0),U("V:7106..57424","worm","viewerWormEgl8NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),U("V:7114..57432","worm","networkExampleWorm1",O.ISOFORM_EMBEDDED_VARIANT,!0,null),U("V:7114..57432","worm","networkExampleWorm1And",O.ISOFORM_AND_VARIANT,!0,null)}function U0(){sn("chrIV:1276345..1277478","yeast","yeastExampleIsoformOnly",O.ISOFORM,!0),sn("25:15029041..15049781","zebrafish","zebrafishExampleIsoformOnly",O.ISOFORM,!0)}function U(t,e,n,r,i,a,s,o){const c=t.split(":")[0],[l,f]=t.split(":")[1].split(".."),d=.01,u=new Yt({locale:"global",chromosome:c,start:l,end:f,showVariantLabel:i,transcriptTypes:hn(),isoformFilter:s||[],variantFilter:a||[],initialHighlight:o||[],binRatio:d,tracks:[{id:12,genome:e,type:r,isoform_url:[`${ue}/track/`,"/All%20Genes/",".json?ignoreCache=true"],variant_url:[`${ue}/vcf/`,"/Variants/",".json"]}]},`#${n}`,900,500),h=document.getElementById(`${n}CloseButton`);h&&h.addEventListener("click",()=>{u.closeModal()});const w=document.getElementById(`${n}LegendTarget`);w&&(w.innerHTML=u.generateLegend()),n==="networkExampleWorm1And"&&(document.getElementById("wormbutton").addEventListener("click",function(){u.setSelectedAlleles(["WB:WBVar00089535","WB:WBVar02125540","WB:WBVar00242477"],"#networkExampleWorm1And")}),document.getElementById("clrbutton").addEventListener("click",function(){u.setSelectedAlleles([],"#networkExampleWorm1And")})),n==="viewerFlyExample2NoLabelAnd"&&(document.getElementById("flybutton").addEventListener("click",function(){u.setSelectedAlleles(["FB:FBal0242675","FB:FBal0302371","FB:FBal0012433"],"#viewerFlyExample2NoLabelAnd")}),document.getElementById("clrbuttonfly").addEventListener("click",function(){u.setSelectedAlleles([],"#viewerFlyExample2NoLabelAnd")})),n==="viewerHighlightExample"&&(document.getElementById("mausbutton").addEventListener("click",function(){u.setSelectedAlleles(["ZFIN:ZDB-ALT-130411-164"],"#viewerHighlightExample")}),document.getElementById("clrbuttonmaus").addEventListener("click",function(){u.setSelectedAlleles([],"#viewerHighlightExample")}))}function sn(t,e,n,r,i,a){const s=t.split(":")[0],[o,c]=t.split(":")[1].split("..");new Yt({locale:"global",chromosome:s,start:o,end:c,transcriptTypes:hn(),showVariantLabel:i,variantFilter:[],tracks:[{id:12,genome:e,type:r,url:[`${ue}/track/`,"/All%20Genes/",".json"]}]},`#${n}`,900,500)}function P0(t,e,n,r,i,a){const s=t.split(":")[0],[o,c]=t.split(":")[1].split("..");new Yt({locale:"global",chromosome:s,start:o,end:c,transcriptTypes:hn(),showVariantLabel:i,variantFilter:[],service:new I0,tracks:[{id:12,genome:e,type:r,url:{baseUrl:"https://s3.amazonaws.com/agrjbrowse/docker/3.2.0/SARS-CoV-2/tracks/",urlTemplate:"All%20Genes/NC_045512.2/trackData.jsonz"}}]},`#${n}`,900,500)}function q0(t,e,n,r,i,a){const s=t.split(":")[0],[o,c]=t.split(":")[1].split("..");new Yt({locale:"global",chromosome:s,start:o,end:c,transcriptTypes:hn(),showVariantLabel:i,variantFilter:[],tracks:[{id:12,genome:e,type:r,url:[`${ue}/track/`,"/Mature%20peptides/",".json?ignoreCache=true&flatten=false"]}]},`#${n}`,900,500)}function G0(){new Yt({locale:"global",chromosome:5,start:75574916,end:75656722,tracks:[{id:2,genome:"Mus musculus",type:O.VARIANT_GLOBAL},{id:1,genome:"Mus musculus",type:O.ISOFORM,url:[`${ue}/apollo/track/`,"/All%20Genes/",".json"]}]},"#viewer1",700,null),new Yt({locale:"global",chromosome:"2L",start:19400752,end:19426596,transcriptTypes:["mRNA","ncRNA","piRNA","lincRNA","miRNA","pre_miRNA","snoRNA","lnc_RNA","tRNA","snRNA","rRNA","ARS","antisense_RNA","C_gene_segment","V_gene_segment","pseudogene_attribute","snoRNA_gene"],tracks:[{id:1,genome:"Drosophila melanogaster",type:O.ISOFORM,url:[`${ue}/apollo/track/`,"/All%20Genes/",".json?name=Pax"]}]},"#viewer2",700,null),new Yt({locale:"local",chromosome:5,start:48515461,end:48515461,centerVariant:!0,tracks:[{id:1,label:"Case Variants",type:O.VARIANT,chromosome:5},{id:2,label:"ClinVar Cases",type:O.VARIANT,chromosome:5}]},"#viewer3",900,400)}
