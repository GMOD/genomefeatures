<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Genome Feature Component Example</title>
    <!-- Import the UMD bundle from unpkg -->
    <script src="https://unpkg.com/genomefeatures/dist/genomefeatures.umd.cjs"></script>
  </head>
  <body>
    <svg id="svgelement"></svg>

    <script>
      async function initializeViewer() {
        const {
          parseLocString,
          fetchNCListData,
          fetchTabixVcfData,
          GenomeFeatureViewer,
        } = window.GenomeFeatureViewer

        const locString = '2L:130639..135911'
        const genome = 'fly'

        const vcfTabixUrl =
          'https://s3.amazonaws.com/agrjbrowse/VCF/7.0.0/fly-latest.vcf.gz'
        const ncListUrlTemplate =
          'https://s3.amazonaws.com/agrjbrowse/docker/7.0.0/FlyBase/fruitfly/tracks/All_Genes/{refseq}/trackData.jsonz'

        const region = parseLocString(locString)
        const trackData = await fetchNCListData({
          region,
          urlTemplate: ncListUrlTemplate,
        })

        const variantData = await fetchTabixVcfData({
          url: vcfTabixUrl,
          region,
        })

        const gfc = new GenomeFeatureViewer(
          {
            region,
            genome,
            tracks: [
              {
                type: 'ISOFORM_EMBEDDED_VARIANT',
                trackData,
                variantData,
              },
            ],
          },
          '#svgelement',
          900,
          500,
        )
      }

      // Initialize when the page loads
      window.addEventListener('load', initializeViewer)
    </script>
  </body>
</html>
